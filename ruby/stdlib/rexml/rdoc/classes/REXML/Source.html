<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: REXML::Source</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">REXML::Source</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/rexml/source_rb.html">
                rexml/source.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                <a href="../Object.html">
                Object
               </a>
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
A <a href="Source.html">Source</a> can be searched for patterns, and wraps
buffers and other objects and provides consumption of text
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M002925">consume</a>&nbsp;&nbsp;
      <a href="#M002931">current_line</a>&nbsp;&nbsp;
      <a href="#M002929">empty?</a>&nbsp;&nbsp;
      <a href="#M002922">encoding=</a>&nbsp;&nbsp;
      <a href="#M002928">match</a>&nbsp;&nbsp;
      <a href="#M002926">match_to</a>&nbsp;&nbsp;
      <a href="#M002927">match_to_consume</a>&nbsp;&nbsp;
      <a href="#M002921">new</a>&nbsp;&nbsp;
      <a href="#M002930">position</a>&nbsp;&nbsp;
      <a href="#M002924">read</a>&nbsp;&nbsp;
      <a href="#M002923">scan</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->
    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">
        <span class="include-name"><a href="Encoding.html">Encoding</a></span>
      </div>
    </div>

    <div id="section">





    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">buffer</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The current buffer (what we&#8216;re going to <a
href="Source.html#M002924">read</a> next)

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">encoding</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">line</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The line number of the last consumed text

</td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M002921" class="m-detail">
        <a name="M002921"></a>

        <div class="method-heading">
          <a href="#M002921" class="method-signature">
          <span class="method-name">new</span><span class="method-args">(arg, encoding=nil)</span>
          </a>
        </div>
      
        <div class="m-description">
          <p>
Constructor @param arg must be a String, and should be a valid XML document
@param encoding if non-null, sets the encoding of the source to this value,
overriding all encoding detection
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M002921-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M002921-source">
<pre>
<span class="ruby-comment cmt"># File rexml/source.rb, line 40</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">arg</span>, <span class="ruby-identifier">encoding</span>=<span class="ruby-keyword kw">nil</span>)
      <span class="ruby-ivar">@orig</span> = <span class="ruby-ivar">@buffer</span> = <span class="ruby-identifier">arg</span>
      <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">encoding</span>
        <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">encoding</span> = <span class="ruby-identifier">encoding</span>
      <span class="ruby-keyword kw">else</span>
        <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">encoding</span> = <span class="ruby-identifier">check_encoding</span>( <span class="ruby-ivar">@buffer</span> )
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-ivar">@line</span> = <span class="ruby-value">0</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M002925" class="m-detail">
        <a name="M002925"></a>

        <div class="method-heading">
          <a href="#M002925" class="method-signature">
          <span class="method-name">consume</span><span class="method-args">( pattern )</span>
          </a>
        </div>
      
        <div class="m-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M002925-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M002925-source">
<pre>
<span class="ruby-comment cmt"># File rexml/source.rb, line 90</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">consume</span>( <span class="ruby-identifier">pattern</span> )
      <span class="ruby-ivar">@buffer</span> = <span class="ruby-identifier">$'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">pattern</span>.<span class="ruby-identifier">match</span>( <span class="ruby-ivar">@buffer</span> )
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M002931" class="m-detail">
        <a name="M002931"></a>

        <div class="method-heading">
          <a href="#M002931" class="method-signature">
          <span class="method-name">current_line</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="m-description">
          <p>
@return the current line in the source
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M002931-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M002931-source">
<pre>
<span class="ruby-comment cmt"># File rexml/source.rb, line 120</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">current_line</span>
      <span class="ruby-identifier">lines</span> = <span class="ruby-ivar">@orig</span>.<span class="ruby-identifier">split</span>
      <span class="ruby-identifier">res</span> = <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">grep</span> <span class="ruby-ivar">@buffer</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">30</span>]
      <span class="ruby-identifier">res</span> = <span class="ruby-identifier">res</span>[<span class="ruby-value">-1</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">res</span>.<span class="ruby-identifier">kind_of?</span> <span class="ruby-constant">Array</span>
      <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">index</span>( <span class="ruby-identifier">res</span> ) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">res</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M002929" class="m-detail">
        <a name="M002929"></a>

        <div class="method-heading">
          <a href="#M002929" class="method-signature">
          <span class="method-name">empty?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="m-description">
          <p>
@return true if the <a href="Source.html">Source</a> is exhausted
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M002929-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M002929-source">
<pre>
<span class="ruby-comment cmt"># File rexml/source.rb, line 111</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">empty?</span>
      <span class="ruby-ivar">@buffer</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M002922" class="m-detail">
        <a name="M002922"></a>

        <div class="method-heading">
          <a href="#M002922" class="method-signature">
          <span class="method-name">encoding=</span><span class="method-args">(enc)</span>
          </a>
        </div>
      
        <div class="m-description">
          <p>
Inherited from <a href="Encoding.html">Encoding</a> Overridden to support
optimized en/decoding
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M002922-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M002922-source">
<pre>
<span class="ruby-comment cmt"># File rexml/source.rb, line 53</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">encoding=</span>(<span class="ruby-identifier">enc</span>)
      <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-keyword kw">super</span>
      <span class="ruby-ivar">@line_break</span> = <span class="ruby-identifier">encode</span>( <span class="ruby-value str">'&gt;'</span> )
      <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">enc</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">UTF_8</span>
        <span class="ruby-ivar">@buffer</span> = <span class="ruby-identifier">decode</span>(<span class="ruby-ivar">@buffer</span>)
        <span class="ruby-ivar">@to_utf</span> = <span class="ruby-keyword kw">true</span>
      <span class="ruby-keyword kw">else</span>
        <span class="ruby-ivar">@to_utf</span> = <span class="ruby-keyword kw">false</span>
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M002928" class="m-detail">
        <a name="M002928"></a>

        <div class="method-heading">
          <a href="#M002928" class="method-signature">
          <span class="method-name">match</span><span class="method-args">(pattern, cons=false)</span>
          </a>
        </div>
      
        <div class="m-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M002928-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M002928-source">
<pre>
<span class="ruby-comment cmt"># File rexml/source.rb, line 104</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">match</span>(<span class="ruby-identifier">pattern</span>, <span class="ruby-identifier">cons</span>=<span class="ruby-keyword kw">false</span>)
      <span class="ruby-identifier">md</span> = <span class="ruby-identifier">pattern</span>.<span class="ruby-identifier">match</span>(<span class="ruby-ivar">@buffer</span>)
      <span class="ruby-ivar">@buffer</span> = <span class="ruby-identifier">$'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">cons</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">md</span>
      <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">md</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M002926" class="m-detail">
        <a name="M002926"></a>

        <div class="method-heading">
          <a href="#M002926" class="method-signature">
          <span class="method-name">match_to</span><span class="method-args">( char, pattern )</span>
          </a>
        </div>
      
        <div class="m-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M002926-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M002926-source">
<pre>
<span class="ruby-comment cmt"># File rexml/source.rb, line 94</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">match_to</span>( <span class="ruby-identifier">char</span>, <span class="ruby-identifier">pattern</span> )
      <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">pattern</span>.<span class="ruby-identifier">match</span>(<span class="ruby-ivar">@buffer</span>)
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M002927" class="m-detail">
        <a name="M002927"></a>

        <div class="method-heading">
          <a href="#M002927" class="method-signature">
          <span class="method-name">match_to_consume</span><span class="method-args">( char, pattern )</span>
          </a>
        </div>
      
        <div class="m-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M002927-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M002927-source">
<pre>
<span class="ruby-comment cmt"># File rexml/source.rb, line 98</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">match_to_consume</span>( <span class="ruby-identifier">char</span>, <span class="ruby-identifier">pattern</span> )
      <span class="ruby-identifier">md</span> = <span class="ruby-identifier">pattern</span>.<span class="ruby-identifier">match</span>(<span class="ruby-ivar">@buffer</span>)
      <span class="ruby-ivar">@buffer</span> = <span class="ruby-identifier">$'</span>
      <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">md</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M002930" class="m-detail">
        <a name="M002930"></a>

        <div class="method-heading">
          <a href="#M002930" class="method-signature">
          <span class="method-name">position</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="m-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M002930-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M002930-source">
<pre>
<span class="ruby-comment cmt"># File rexml/source.rb, line 115</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">position</span>
      <span class="ruby-ivar">@orig</span>.<span class="ruby-identifier">index</span>( <span class="ruby-ivar">@buffer</span> )
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M002924" class="m-detail">
        <a name="M002924"></a>

        <div class="method-heading">
          <a href="#M002924" class="method-signature">
          <span class="method-name">read</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="m-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M002924-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M002924-source">
<pre>
<span class="ruby-comment cmt"># File rexml/source.rb, line 87</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">read</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M002923" class="m-detail">
        <a name="M002923"></a>

        <div class="method-heading">
          <a href="#M002923" class="method-signature">
          <span class="method-name">scan</span><span class="method-args">(pattern, cons=false)</span>
          </a>
        </div>
      
        <div class="m-description">
          <p>
Scans the source for a given pattern. Note, that this is not your usual <a
href="Source.html#M002923">scan</a>() method. For one thing, the pattern
argument has some requirements; for another, the source can be consumed.
You can easily confuse this method. Originally, the patterns were easier to
construct and this method more robust, because this method generated search
regexes on the fly; however, this was computationally expensive and slowed
down the entire <a href="../REXML.html">REXML</a> package considerably,
since this is by far the most commonly called method. @param pattern must
be a Regexp, and must be in the form of /^\s*(#{your pattern, with no
groups})(.*)/. The first group will be returned; the second group is used
if the <a href="Source.html#M002925">consume</a> flag is set. @param <a
href="Source.html#M002925">consume</a> if true, the pattern returned will
be consumed, leaving everything after it in the <a
href="Source.html">Source</a>. @return the pattern, if found, or nil if the
<a href="Source.html">Source</a> is empty or the pattern is not found.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M002923-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M002923-source">
<pre>
<span class="ruby-comment cmt"># File rexml/source.rb, line 80</span>
    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">scan</span>(<span class="ruby-identifier">pattern</span>, <span class="ruby-identifier">cons</span>=<span class="ruby-keyword kw">false</span>)
      <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@buffer</span>.<span class="ruby-identifier">nil?</span>
      <span class="ruby-identifier">rv</span> = <span class="ruby-ivar">@buffer</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-identifier">pattern</span>)
      <span class="ruby-ivar">@buffer</span> = <span class="ruby-identifier">$'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">cons</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">rv</span>.<span class="ruby-identifier">size</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span>
      <span class="ruby-identifier">rv</span>
    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>
<div id='credits' style='font-size:smaller' >
<!-- 1  --><p> <a href='http://www.ruby-doc.org'>ruby-doc.org</a> is hosted and maintained by <a href='http://www.jamesbritt.com'>James Britt</a> and <a href='http://www.happycamperstudios.com'>Happy Camper Studios</a>, a <a href='http://www.happycamperstudios.com'> Ruby application development company in Phoenix, Arizona</a>. The site was created in 2002 as part of the Ruby Documentation Project to promote the Ruby language and to help other Ruby hackers.</p>
 <p>Documentation content on ruby-doc.org is provided by <a href='http://www.ruby-doc.org/about'>remarkable members</a> of the Ruby community.</p>
<p>For more information on the Ruby programming language, visit <a href='http://www.ruby-lang.org'>ruby-lang.org</a>.</p>
<p>Want to help improve Ruby's API docs? See <a href='/documentation-guidelines.html'> Ruby Documentation Guidelines</a>.</p>
</div>

</body>
</html>