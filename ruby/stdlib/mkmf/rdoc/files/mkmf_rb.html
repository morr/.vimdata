<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>File: mkmf.rb</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



  <div id="fileHeader">
    <h1>mkmf.rb</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>mkmf.rb
      </td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Wed Mar 18 16:30:32 -0500 2009</td>
    </tr>
    </table>
  </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
module to create Makefile for extension modules invoke like: ruby -r mkmf
extconf.rb
</p>

    </div>

    <div id="requires-list">
      <h3 class="section-bar">Required files</h3>

      <div class="name-list">
      rbconfig&nbsp;&nbsp;
      fileutils&nbsp;&nbsp;
      shellwords&nbsp;&nbsp;
      </div>
    </div>

   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000526">append_library</a>&nbsp;&nbsp;
      <a href="#M000545">arg_config</a>&nbsp;&nbsp;
      <a href="#M000506">cc_command</a>&nbsp;&nbsp;
      <a href="#M000539">check_sizeof</a>&nbsp;&nbsp;
      <a href="#M000528">checking_for</a>&nbsp;&nbsp;
      <a href="#M000529">checking_message</a>&nbsp;&nbsp;
      <a href="#M000493">config_string</a>&nbsp;&nbsp;
      <a href="#M000553">configuration</a>&nbsp;&nbsp;
      <a href="#M000507">cpp_command</a>&nbsp;&nbsp;
      <a href="#M000513">cpp_include</a>&nbsp;&nbsp;
      <a href="#M000548">create_header</a>&nbsp;&nbsp;
      <a href="#M000555">create_makefile</a>&nbsp;&nbsp;
      <a href="#M000503">create_tmpsrc</a>&nbsp;&nbsp;
      <a href="#M000549">dir_config</a>&nbsp;&nbsp;
      <a href="#M000494">dir_re</a>&nbsp;&nbsp;
      <a href="#M000554">dummy_makefile</a>&nbsp;&nbsp;
      <a href="#M000521">egrep_cpp</a>&nbsp;&nbsp;
      <a href="#M000547">enable_config</a>&nbsp;&nbsp;
      <a href="#M000544">find_executable</a>&nbsp;&nbsp;
      <a href="#M000543">find_executable0</a>&nbsp;&nbsp;
      <a href="#M000536">find_header</a>&nbsp;&nbsp;
      <a href="#M000532">find_library</a>&nbsp;&nbsp;
      <a href="#M000533">have_func</a>&nbsp;&nbsp;
      <a href="#M000535">have_header</a>&nbsp;&nbsp;
      <a href="#M000531">have_library</a>&nbsp;&nbsp;
      <a href="#M000530">have_macro</a>&nbsp;&nbsp;
      <a href="#M000537">have_struct_member</a>&nbsp;&nbsp;
      <a href="#M000538">have_type</a>&nbsp;&nbsp;
      <a href="#M000534">have_var</a>&nbsp;&nbsp;
      <a href="#M000556">init_mkmf</a>&nbsp;&nbsp;
      <a href="#M000495">install_dirs</a>&nbsp;&nbsp;
      <a href="#M000524">install_files</a>&nbsp;&nbsp;
      <a href="#M000525">install_rb</a>&nbsp;&nbsp;
      <a href="#M000508">libpathflag</a>&nbsp;&nbsp;
      <a href="#M000505">link_command</a>&nbsp;&nbsp;
      <a href="#M000502">log_src</a>&nbsp;&nbsp;
      <a href="#M000522">macro_defined?</a>&nbsp;&nbsp;
      <a href="#M000496">map_dir</a>&nbsp;&nbsp;
      <a href="#M000499">merge_libs</a>&nbsp;&nbsp;
      <a href="#M000527">message</a>&nbsp;&nbsp;
      <a href="#M000557">mkmf_failed</a>&nbsp;&nbsp;
      <a href="#M000498">modified?</a>&nbsp;&nbsp;
      <a href="#M000550">pkg_config</a>&nbsp;&nbsp;
      <a href="#M000497">rm_f</a>&nbsp;&nbsp;
      <a href="#M000540">scalar_ptr_type?</a>&nbsp;&nbsp;
      <a href="#M000541">scalar_type?</a>&nbsp;&nbsp;
      <a href="#M000511">try_compile</a>&nbsp;&nbsp;
      <a href="#M000518">try_constant</a>&nbsp;&nbsp;
      <a href="#M000512">try_cpp</a>&nbsp;&nbsp;
      <a href="#M000504">try_do</a>&nbsp;&nbsp;
      <a href="#M000519">try_func</a>&nbsp;&nbsp;
      <a href="#M000510">try_link</a>&nbsp;&nbsp;
      <a href="#M000509">try_link0</a>&nbsp;&nbsp;
      <a href="#M000523">try_run</a>&nbsp;&nbsp;
      <a href="#M000517">try_static_assert</a>&nbsp;&nbsp;
      <a href="#M000520">try_var</a>&nbsp;&nbsp;
      <a href="#M000542">what_type?</a>&nbsp;&nbsp;
      <a href="#M000552">winsep</a>&nbsp;&nbsp;
      <a href="#M000515">with_cflags</a>&nbsp;&nbsp;
      <a href="#M000546">with_config</a>&nbsp;&nbsp;
      <a href="#M000514">with_cppflags</a>&nbsp;&nbsp;
      <a href="#M000551">with_destdir</a>&nbsp;&nbsp;
      <a href="#M000516">with_ldflags</a>&nbsp;&nbsp;
      <a href="#M000501">xpopen</a>&nbsp;&nbsp;
      <a href="#M000500">xsystem</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">


    <div id="constants-list">
      <h3 class="section-bar">Constants</h3>

      <div class="name-list">
        <table summary="Constants">
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">CONFIG</td>
          <td>=</td>
          <td class="context-item-value">Config::MAKEFILE_CONFIG</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">ORIG_LIBPATH</td>
          <td>=</td>
          <td class="context-item-value">ENV['LIB']</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">CXX_EXT</td>
          <td>=</td>
          <td class="context-item-value">%w[cc cxx cpp]</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">SRC_EXT</td>
          <td>=</td>
          <td class="context-item-value">%w[c m] &lt;&lt; CXX_EXT</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">INSTALL_DIRS</td>
          <td>=</td>
          <td class="context-item-value">[   [dir_re('commondir'), &quot;$(RUBYCOMMONDIR)&quot;],   [dir_re(&quot;sitedir&quot;), &quot;$(RUBYCOMMONDIR)&quot;],   [dir_re('rubylibdir'), &quot;$(RUBYLIBDIR)&quot;],   [dir_re('archdir'), &quot;$(RUBYARCHDIR)&quot;],   [dir_re('sitelibdir'), &quot;$(RUBYLIBDIR)&quot;],   [dir_re('sitearchdir'), &quot;$(RUBYARCHDIR)&quot;]</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">OUTFLAG</td>
          <td>=</td>
          <td class="context-item-value">CONFIG['OUTFLAG']</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">CPPOUTFILE</td>
          <td>=</td>
          <td class="context-item-value">CONFIG['CPPOUTFILE']</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">CONFTEST_C</td>
          <td>=</td>
          <td class="context-item-value">&quot;conftest.c&quot;</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">FailedMessage</td>
          <td>=</td>
          <td class="context-item-value">&lt;&lt;MESSAGE Could not create Makefile due to some reason, probably lack of necessary libraries and/or headers.  Check the mkmf.log file for more details.  You may need configuration options.  Provided configuration options: MESSAGE</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">EXPORT_PREFIX</td>
          <td>=</td>
          <td class="context-item-value">config_string('EXPORT_PREFIX') {|s| s.strip}</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">COMMON_HEADERS</td>
          <td>=</td>
          <td class="context-item-value">hdr.join(&quot;\n&quot;)</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">COMMON_LIBS</td>
          <td>=</td>
          <td class="context-item-value">config_string('COMMON_LIBS', &amp;split) || []</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">COMPILE_RULES</td>
          <td>=</td>
          <td class="context-item-value">config_string('COMPILE_RULES', &amp;split) || %w[.%s.%s:]</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">RULE_SUBST</td>
          <td>=</td>
          <td class="context-item-value">config_string('RULE_SUBST')</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">COMPILE_C</td>
          <td>=</td>
          <td class="context-item-value">config_string('COMPILE_C') || '$(CC) $(INCFLAGS) $(CPPFLAGS) $(CFLAGS) -c $&lt;'</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">COMPILE_CXX</td>
          <td>=</td>
          <td class="context-item-value">config_string('COMPILE_CXX') || '$(CXX) $(INCFLAGS) $(CPPFLAGS) $(CXXFLAGS) -c $&lt;'</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">TRY_LINK</td>
          <td>=</td>
          <td class="context-item-value">config_string('TRY_LINK') ||   &quot;$(CC) #{OUTFLAG}conftest $(INCFLAGS) $(CPPFLAGS) &quot; \   &quot;$(CFLAGS) $(src) $(LIBPATH) $(LDFLAGS) $(ARCH_FLAG) $(LOCAL_LIBS) $(LIBS)&quot;</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">LINK_SO</td>
          <td>=</td>
          <td class="context-item-value">config_string('LINK_SO') ||   if CONFIG[&quot;DLEXT&quot;] == $OBJEXT</td>
        </tr>
        </table>
      </div>
    </div>



      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000526" class="method-detail">
        <a name="M000526"></a>

        <div class="method-heading">
          <a href="#M000526" class="method-signature">
          <span class="method-name">append_library</span><span class="method-args">(libs, lib)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000526-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000526-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 540</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">append_library</span>(<span class="ruby-identifier">libs</span>, <span class="ruby-identifier">lib</span>)
  <span class="ruby-identifier">format</span>(<span class="ruby-constant">LIBARG</span>, <span class="ruby-identifier">lib</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">&quot; &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">libs</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000545" class="method-detail">
        <a name="M000545"></a>

        <div class="method-heading">
          <a href="#M000545" class="method-signature">
          <span class="method-name">arg_config</span><span class="method-args">(config, *defaults, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000545-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000545-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 898</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">arg_config</span>(<span class="ruby-identifier">config</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">defaults</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">$arg_config</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">config</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">defaults</span>]
  <span class="ruby-identifier">defaults</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">block</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">defaults</span>.<span class="ruby-identifier">empty?</span>
  <span class="ruby-identifier">$configure_args</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-identifier">config</span>.<span class="ruby-identifier">tr</span>(<span class="ruby-value str">'_'</span>, <span class="ruby-value str">'-'</span>), <span class="ruby-operator">*</span><span class="ruby-identifier">defaults</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000506" class="method-detail">
        <a name="M000506"></a>

        <div class="method-heading">
          <a href="#M000506" class="method-signature">
          <span class="method-name">cc_command</span><span class="method-args">(opt=&quot;&quot;)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000506-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000506-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 284</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">cc_command</span>(<span class="ruby-identifier">opt</span>=<span class="ruby-value str">&quot;&quot;</span>)
  <span class="ruby-identifier">conf</span> = <span class="ruby-constant">Config</span><span class="ruby-operator">::</span><span class="ruby-constant">CONFIG</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value str">'hdrdir'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">$hdrdir</span>.<span class="ruby-identifier">quote</span>, <span class="ruby-value str">'srcdir'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">$srcdir</span>.<span class="ruby-identifier">quote</span>)
  <span class="ruby-constant">Config</span><span class="ruby-operator">::</span><span class="ruby-identifier">expand</span>(<span class="ruby-node">&quot;$(CC) #$INCFLAGS #$CPPFLAGS #$CFLAGS #$ARCH_FLAG #{opt} -c #{CONFTEST_C}&quot;</span>,
                 <span class="ruby-identifier">conf</span>)
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000539" class="method-detail">
        <a name="M000539"></a>

        <div class="method-heading">
          <a href="#M000539" class="method-signature">
          <span class="method-name">check_sizeof</span><span class="method-args">(type, headers = nil, &amp;b)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the size of the given <tt>type</tt>. You may optionally specify
additional <tt>headers</tt> to search in for the <tt>type</tt>.
</p>
<p>
If found, a macro is passed as a preprocessor constant to the compiler
using the type name, in uppercase, prepended with &#8216;SIZEOF_&#8217;,
followed by the type name, followed by &#8217;=X&#8217; where
&#8216;X&#8217; is the actual size.
</p>
<p>
For example, if <a
href="mkmf_rb.html#M000539">check_sizeof</a>(&#8216;mystruct&#8217;)
returned 12, then the SIZEOF_MYSTRUCT=12 preprocessor macro would be passed
to the compiler.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000539-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000539-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 802</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">check_sizeof</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">headers</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
  <span class="ruby-identifier">expr</span> = <span class="ruby-node">&quot;sizeof(#{type})&quot;</span>
  <span class="ruby-identifier">fmt</span> = <span class="ruby-value str">&quot;%d&quot;</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">fmt</span>.<span class="ruby-operator">%</span>(<span class="ruby-identifier">x</span>)
    <span class="ruby-identifier">x</span> <span class="ruby-value">? </span><span class="ruby-keyword kw">super</span> <span class="ruby-operator">:</span> <span class="ruby-value str">&quot;failed&quot;</span>
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-identifier">checking_for</span> <span class="ruby-identifier">checking_message</span>(<span class="ruby-node">&quot;size of #{type}&quot;</span>, <span class="ruby-identifier">headers</span>), <span class="ruby-identifier">fmt</span> <span class="ruby-keyword kw">do</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">size</span> = <span class="ruby-identifier">try_constant</span>(<span class="ruby-identifier">expr</span>, <span class="ruby-identifier">headers</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
      <span class="ruby-identifier">$defs</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">format</span>(<span class="ruby-value str">&quot;-DSIZEOF_%s=%d&quot;</span>, <span class="ruby-identifier">type</span>.<span class="ruby-identifier">upcase</span>.<span class="ruby-identifier">tr_s</span>(<span class="ruby-value str">&quot;^A-Z0-9_&quot;</span>, <span class="ruby-value str">&quot;_&quot;</span>), <span class="ruby-identifier">size</span>))
      <span class="ruby-identifier">size</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000528" class="method-detail">
        <a name="M000528"></a>

        <div class="method-heading">
          <a href="#M000528" class="method-signature">
          <span class="method-name">checking_for</span><span class="method-args">(m, fmt = nil) {|| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000528-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000528-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 551</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">checking_for</span>(<span class="ruby-identifier">m</span>, <span class="ruby-identifier">fmt</span> = <span class="ruby-keyword kw">nil</span>)
  <span class="ruby-identifier">f</span> = <span class="ruby-identifier">caller</span>[<span class="ruby-value">0</span>][<span class="ruby-regexp re">/in `(.*)'$/</span>, <span class="ruby-value">1</span>] <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">f</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;: &quot;</span> <span class="ruby-comment cmt">#` for vim</span>
  <span class="ruby-identifier">m</span> = <span class="ruby-node">&quot;checking #{/\Acheck/ =~ f ? '' : 'for '}#{m}... &quot;</span>
  <span class="ruby-identifier">message</span> <span class="ruby-value str">&quot;%s&quot;</span>, <span class="ruby-identifier">m</span>
  <span class="ruby-identifier">a</span> = <span class="ruby-identifier">r</span> = <span class="ruby-keyword kw">nil</span>
  <span class="ruby-constant">Logging</span><span class="ruby-operator">::</span><span class="ruby-identifier">postpone</span> <span class="ruby-keyword kw">do</span>
    <span class="ruby-identifier">r</span> = <span class="ruby-keyword kw">yield</span>
    <span class="ruby-identifier">a</span> = (<span class="ruby-identifier">fmt</span> <span class="ruby-value">? </span><span class="ruby-identifier">fmt</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">r</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">r</span> <span class="ruby-value">? </span><span class="ruby-value str">&quot;yes&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-value str">&quot;no&quot;</span>) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span>
    <span class="ruby-node">&quot;#{f}#{m}-------------------- #{a}\n&quot;</span>
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-identifier">message</span>(<span class="ruby-identifier">a</span>)
  <span class="ruby-constant">Logging</span><span class="ruby-operator">::</span><span class="ruby-identifier">message</span> <span class="ruby-value str">&quot;--------------------\n\n&quot;</span>
  <span class="ruby-identifier">r</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000529" class="method-detail">
        <a name="M000529"></a>

        <div class="method-heading">
          <a href="#M000529" class="method-signature">
          <span class="method-name">checking_message</span><span class="method-args">(target, place = nil, opt = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000529-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000529-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 566</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">checking_message</span>(<span class="ruby-identifier">target</span>, <span class="ruby-identifier">place</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">opt</span> = <span class="ruby-keyword kw">nil</span>)
  [[<span class="ruby-value str">&quot;in&quot;</span>, <span class="ruby-identifier">place</span>], [<span class="ruby-value str">&quot;with&quot;</span>, <span class="ruby-identifier">opt</span>]].<span class="ruby-identifier">inject</span>(<span class="ruby-node">&quot;#{target}&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">msg</span>, (<span class="ruby-identifier">pre</span>, <span class="ruby-identifier">noun</span>)<span class="ruby-operator">|</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">noun</span>
      [[<span class="ruby-identifier">:to_str</span>], [<span class="ruby-identifier">:join</span>, <span class="ruby-value str">&quot;,&quot;</span>], [<span class="ruby-identifier">:to_s</span>]].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">meth</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span><span class="ruby-operator">|</span>
        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">noun</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">meth</span>)
          <span class="ruby-keyword kw">break</span> <span class="ruby-identifier">noun</span> = <span class="ruby-identifier">noun</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">meth</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-identifier">msg</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot; #{pre} #{noun}&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">noun</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-keyword kw">end</span>
    <span class="ruby-identifier">msg</span>
  <span class="ruby-keyword kw">end</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000493" class="method-detail">
        <a name="M000493"></a>

        <div class="method-heading">
          <a href="#M000493" class="method-signature">
          <span class="method-name">config_string</span><span class="method-args">(key, config = CONFIG) {|s| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000493-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000493-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 66</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">config_string</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">config</span> = <span class="ruby-constant">CONFIG</span>)
  <span class="ruby-identifier">s</span> = <span class="ruby-identifier">config</span>[<span class="ruby-identifier">key</span>] <span class="ruby-keyword kw">and</span> <span class="ruby-operator">!</span><span class="ruby-identifier">s</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">block_given?</span> <span class="ruby-value">? </span><span class="ruby-keyword kw">yield</span>(<span class="ruby-identifier">s</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">s</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000553" class="method-detail">
        <a name="M000553"></a>

        <div class="method-heading">
          <a href="#M000553" class="method-signature">
          <span class="method-name">configuration</span><span class="method-args">(srcdir)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000553-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000553-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 1045</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">configuration</span>(<span class="ruby-identifier">srcdir</span>)
  <span class="ruby-identifier">mk</span> = []
  <span class="ruby-identifier">vpath</span> = <span class="ruby-node">%w[$(srcdir) $(topdir) $(hdrdir)]</span>
  <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-constant">CROSS_COMPILING</span>
    <span class="ruby-keyword kw">case</span> <span class="ruby-constant">CONFIG</span>[<span class="ruby-value str">'build_os'</span>]
    <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'cygwin'</span>
      <span class="ruby-keyword kw">if</span> <span class="ruby-constant">CONFIG</span>[<span class="ruby-value str">'target_os'</span>] <span class="ruby-operator">!=</span> <span class="ruby-value str">'cygwin'</span>
        <span class="ruby-identifier">vpath</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">sub!</span>(<span class="ruby-regexp re">/.*/</span>, <span class="ruby-value str">'$(shell cygpath -u \&amp;)'</span>)}
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'msdosdjgpp'</span>, <span class="ruby-value str">'mingw32'</span>
      <span class="ruby-constant">CONFIG</span>[<span class="ruby-value str">'PATH_SEPARATOR'</span>] = <span class="ruby-value str">';'</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-identifier">mk</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">%{
SHELL = /bin/sh

#### Start of system configuration section. ####

srcdir = #{srcdir.gsub(/\$\((srcdir)\)|\$\{(srcdir)\}/) {CONFIG[$1||$2]}.quote}
topdir = #{($extmk ? CONFIG[&quot;topdir&quot;] : $topdir).quote}
hdrdir = #{$extmk ? CONFIG[&quot;hdrdir&quot;].quote : '$(topdir)'}
VPATH = #{vpath.join(CONFIG['PATH_SEPARATOR'])}
}</span>
  <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$extmk</span>
    <span class="ruby-identifier">mk</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;RUBYLIB = -\nRUBYOPT = -rpurelib.rb\n&quot;</span>
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">destdir</span> = <span class="ruby-constant">CONFIG</span>[<span class="ruby-value str">&quot;prefix&quot;</span>][<span class="ruby-identifier">$dest_prefix_pattern</span>, <span class="ruby-value">1</span>]
    <span class="ruby-identifier">mk</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;\nDESTDIR = #{destdir}\n&quot;</span>
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-constant">CONFIG</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">var</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-regexp re">/prefix$/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">key</span>
    <span class="ruby-identifier">mk</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{key} = #{with_destdir(var)}\n&quot;</span>
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-constant">CONFIG</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">var</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-regexp re">/^abs_/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">key</span>
    <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-regexp re">/^(?:src|top|hdr|(.*))dir$/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">key</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">$1</span>
    <span class="ruby-identifier">mk</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{key} = #{with_destdir(var)}\n&quot;</span>
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">$extmk</span> <span class="ruby-keyword kw">and</span> <span class="ruby-operator">!</span><span class="ruby-identifier">$configure_args</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value str">'--ruby'</span>) <span class="ruby-keyword kw">and</span>
      <span class="ruby-identifier">sep</span> = <span class="ruby-identifier">config_string</span>(<span class="ruby-value str">'BUILD_FILE_SEPARATOR'</span>)
    <span class="ruby-identifier">sep</span> = <span class="ruby-node">&quot;:/=#{sep}&quot;</span>
  <span class="ruby-keyword kw">else</span>
    <span class="ruby-identifier">sep</span> = <span class="ruby-value str">&quot;&quot;</span>
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-identifier">extconf_h</span> = <span class="ruby-identifier">$extconf_h</span> <span class="ruby-operator">?</span> <span class="ruby-value str">&quot;-DRUBY_EXTCONF_H=\\\&quot;$(RUBY_EXTCONF_H)\\\&quot; &quot;</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">$defs</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot; &quot;</span>)<span class="ruby-operator">&lt;&lt;</span><span class="ruby-value str">&quot; &quot;</span>
  <span class="ruby-identifier">mk</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">%{
CC = #{CONFIG['CC']}
LIBRUBY = #{CONFIG['LIBRUBY']}
LIBRUBY_A = #{CONFIG['LIBRUBY_A']}
LIBRUBYARG_SHARED = #$LIBRUBYARG_SHARED
LIBRUBYARG_STATIC = #$LIBRUBYARG_STATIC

RUBY_EXTCONF_H = #{$extconf_h}
CFLAGS   = #{$static ? '' : CONFIG['CCDLFLAGS']} #$CFLAGS #$ARCH_FLAG
INCFLAGS = -I. #$INCFLAGS
DEFS     = #{CONFIG['DEFS']}
CPPFLAGS = #{extconf_h}#{$CPPFLAGS}
CXXFLAGS = $(CFLAGS) #{CONFIG['CXXFLAGS']}
DLDFLAGS = #$LDFLAGS #$DLDFLAGS #$ARCH_FLAG
LDSHARED = #{CONFIG['LDSHARED']}
AR = #{CONFIG['AR']}
EXEEXT = #{CONFIG['EXEEXT']}

RUBY_INSTALL_NAME = #{CONFIG['RUBY_INSTALL_NAME']}
RUBY_SO_NAME = #{CONFIG['RUBY_SO_NAME']}
arch = #{CONFIG['arch']}
sitearch = #{CONFIG['sitearch']}
ruby_version = #{Config::CONFIG['ruby_version']}
ruby = #{$ruby}
RUBY = $(ruby#{sep})
RM = #{config_string('RM') || '$(RUBY) -run -e rm -- -f'}
MAKEDIRS = #{config_string('MAKEDIRS') || '@$(RUBY) -run -e mkdir -- -p'}
INSTALL = #{config_string('INSTALL') || '@$(RUBY) -run -e install -- -vp'}
INSTALL_PROG = #{config_string('INSTALL_PROG') || '$(INSTALL) -m 0755'}
INSTALL_DATA = #{config_string('INSTALL_DATA') || '$(INSTALL) -m 0644'}
COPY = #{config_string('CP') || '@$(RUBY) -run -e cp -- -v'}

#### End of system configuration section. ####

preload = #{$preload ? $preload.join(' ') : ''}
}</span>
  <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$nmake</span> <span class="ruby-operator">==</span> <span class="ruby-value">?b</span>
    <span class="ruby-identifier">mk</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">x</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/^(MAKEDIRS|INSTALL_(?:PROG|DATA))+\s*=.*\n/</span>) <span class="ruby-keyword kw">do</span>
        <span class="ruby-value str">&quot;!ifndef &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">$1</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;\n&quot;</span> <span class="ruby-operator">+</span>
        <span class="ruby-identifier">$&amp;</span> <span class="ruby-operator">+</span>
        <span class="ruby-value str">&quot;!endif\n&quot;</span>
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-identifier">mk</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000507" class="method-detail">
        <a name="M000507"></a>

        <div class="method-heading">
          <a href="#M000507" class="method-signature">
          <span class="method-name">cpp_command</span><span class="method-args">(outfile, opt=&quot;&quot;)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000507-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000507-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 290</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">cpp_command</span>(<span class="ruby-identifier">outfile</span>, <span class="ruby-identifier">opt</span>=<span class="ruby-value str">&quot;&quot;</span>)
  <span class="ruby-identifier">conf</span> = <span class="ruby-constant">Config</span><span class="ruby-operator">::</span><span class="ruby-constant">CONFIG</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value str">'hdrdir'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">$hdrdir</span>.<span class="ruby-identifier">quote</span>, <span class="ruby-value str">'srcdir'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">$srcdir</span>.<span class="ruby-identifier">quote</span>)
  <span class="ruby-constant">Config</span><span class="ruby-operator">::</span><span class="ruby-identifier">expand</span>(<span class="ruby-node">&quot;$(CPP) #$INCFLAGS #$CPPFLAGS #$CFLAGS #{opt} #{CONFTEST_C} #{outfile}&quot;</span>,
                 <span class="ruby-identifier">conf</span>)
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000513" class="method-detail">
        <a name="M000513"></a>

        <div class="method-heading">
          <a href="#M000513" class="method-signature">
          <span class="method-name">cpp_include</span><span class="method-args">(header)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000513-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000513-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 329</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">cpp_include</span>(<span class="ruby-identifier">header</span>)
  <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">header</span>
    <span class="ruby-identifier">header</span> = [<span class="ruby-identifier">header</span>] <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">header</span>.<span class="ruby-identifier">kind_of?</span> <span class="ruby-constant">Array</span>
    <span class="ruby-identifier">header</span>.<span class="ruby-identifier">map</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">h</span><span class="ruby-operator">|</span> <span class="ruby-node">&quot;#include &lt;#{h}&gt;\n&quot;</span>}.<span class="ruby-identifier">join</span>
  <span class="ruby-keyword kw">else</span>
    <span class="ruby-value str">&quot;&quot;</span>
  <span class="ruby-keyword kw">end</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000548" class="method-detail">
        <a name="M000548"></a>

        <div class="method-heading">
          <a href="#M000548" class="method-signature">
          <span class="method-name">create_header</span><span class="method-args">(header = &quot;extconf.h&quot;)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000548-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000548-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 937</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create_header</span>(<span class="ruby-identifier">header</span> = <span class="ruby-value str">&quot;extconf.h&quot;</span>)
  <span class="ruby-identifier">message</span> <span class="ruby-value str">&quot;creating %s\n&quot;</span>, <span class="ruby-identifier">header</span>
  <span class="ruby-identifier">sym</span> = <span class="ruby-identifier">header</span>.<span class="ruby-identifier">tr</span>(<span class="ruby-value str">&quot;a-z./\055&quot;</span>, <span class="ruby-value str">&quot;A-Z___&quot;</span>)
  <span class="ruby-identifier">hdr</span> = [<span class="ruby-node">&quot;#ifndef #{sym}\n#define #{sym}\n&quot;</span>]
  <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">line</span> <span class="ruby-keyword kw">in</span> <span class="ruby-identifier">$defs</span>
    <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">line</span>
    <span class="ruby-keyword kw">when</span> <span class="ruby-regexp re">/^-D([^=]+)(?:=(.*))?/</span>
      <span class="ruby-identifier">hdr</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#define #$1 #{$2 ? Shellwords.shellwords($2)[0] : 1}\n&quot;</span>
    <span class="ruby-keyword kw">when</span> <span class="ruby-regexp re">/^-U(.*)/</span>
      <span class="ruby-identifier">hdr</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;#undef #$1\n&quot;</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-identifier">hdr</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;#endif\n&quot;</span>
  <span class="ruby-identifier">hdr</span> = <span class="ruby-identifier">hdr</span>.<span class="ruby-identifier">join</span>
  <span class="ruby-keyword kw">unless</span> (<span class="ruby-constant">IO</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">header</span>) <span class="ruby-operator">==</span> <span class="ruby-identifier">hdr</span> <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">false</span>)
    <span class="ruby-identifier">open</span>(<span class="ruby-identifier">header</span>, <span class="ruby-value str">&quot;w&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">hfile</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">hfile</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">hdr</span>)
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-identifier">$extconf_h</span> = <span class="ruby-identifier">header</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000555" class="method-detail">
        <a name="M000555"></a>

        <div class="method-heading">
          <a href="#M000555" class="method-signature">
          <span class="method-name">create_makefile</span><span class="method-args">(target, srcprefix = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Generates the Makefile for your extension, passing along any options and
preprocessor constants that you may have generated through other methods.
</p>
<p>
The <tt>target</tt> name should correspond the name of the global function
name defined within your C extension, minus the &#8216;Init_&#8217;. For
example, if your C extension is defined as &#8216;Init_foo&#8217;, then
your target would simply be &#8216;foo&#8217;.
</p>
<p>
If any &#8217;/&#8217; characters are present in the target name, only the
last name is interpreted as the target name, and the rest are considered
toplevel directory names, and the generated Makefile will be altered
accordingly to follow that directory structure.
</p>
<p>
For example, if you pass &#8216;test/foo&#8217; as a target name, your
extension will be installed under the &#8216;test&#8217; directory. This
means that in order to load the file within a Ruby program later, that
directory structure will have to be followed, e.g. &quot;require
&#8216;test/foo&#8217;&quot;.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000555-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000555-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 1166</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create_makefile</span>(<span class="ruby-identifier">target</span>, <span class="ruby-identifier">srcprefix</span> = <span class="ruby-keyword kw">nil</span>)
  <span class="ruby-identifier">$target</span> = <span class="ruby-identifier">target</span>
  <span class="ruby-identifier">libpath</span> = <span class="ruby-identifier">$DEFLIBPATH</span><span class="ruby-operator">|</span><span class="ruby-identifier">$LIBPATH</span>
  <span class="ruby-identifier">message</span> <span class="ruby-value str">&quot;creating Makefile\n&quot;</span>
  <span class="ruby-identifier">rm_f</span> <span class="ruby-value str">&quot;conftest*&quot;</span>
  <span class="ruby-keyword kw">if</span> <span class="ruby-constant">CONFIG</span>[<span class="ruby-value str">&quot;DLEXT&quot;</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">$OBJEXT</span>
    <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">lib</span> <span class="ruby-keyword kw">in</span> <span class="ruby-identifier">libs</span> = <span class="ruby-identifier">$libs</span>.<span class="ruby-identifier">split</span>
      <span class="ruby-identifier">lib</span>.<span class="ruby-identifier">sub!</span>(<span class="ruby-regexp re">/-l(.*)/</span>, <span class="ruby-node">%%&quot;lib\\1.#{$LIBEXT}&quot;%</span>)
    <span class="ruby-keyword kw">end</span>
    <span class="ruby-identifier">$defs</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">format</span>(<span class="ruby-value str">&quot;-DEXTLIB='%s'&quot;</span>, <span class="ruby-identifier">libs</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;,&quot;</span>)))
  <span class="ruby-keyword kw">end</span>

  <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">target</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">'/'</span>)
    <span class="ruby-identifier">target_prefix</span>, <span class="ruby-identifier">target</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">split</span>(<span class="ruby-identifier">target</span>)
    <span class="ruby-identifier">target_prefix</span>[<span class="ruby-value">0</span>,<span class="ruby-value">0</span>] = <span class="ruby-value str">'/'</span>
  <span class="ruby-keyword kw">else</span>
    <span class="ruby-identifier">target_prefix</span> = <span class="ruby-value str">&quot;&quot;</span>
  <span class="ruby-keyword kw">end</span>

  <span class="ruby-identifier">srcprefix</span> <span class="ruby-operator">||=</span> <span class="ruby-value str">'$(srcdir)'</span>
  <span class="ruby-constant">Config</span><span class="ruby-operator">::</span><span class="ruby-identifier">expand</span>(<span class="ruby-identifier">srcdir</span> = <span class="ruby-identifier">srcprefix</span>.<span class="ruby-identifier">dup</span>)

  <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">not</span> <span class="ruby-identifier">$objs</span>
    <span class="ruby-identifier">$objs</span> = []
    <span class="ruby-identifier">srcs</span> = <span class="ruby-constant">Dir</span>[<span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">srcdir</span>, <span class="ruby-node">&quot;*.{#{SRC_EXT.join(%q{,})}}&quot;</span>)]
    <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">f</span> <span class="ruby-keyword kw">in</span> <span class="ruby-identifier">srcs</span>
      <span class="ruby-identifier">obj</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-identifier">f</span>, <span class="ruby-value str">&quot;.*&quot;</span>) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;.o&quot;</span>
      <span class="ruby-identifier">$objs</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">obj</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">$objs</span>.<span class="ruby-identifier">index</span>(<span class="ruby-identifier">obj</span>)
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">elsif</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">srcs</span> = <span class="ruby-identifier">$srcs</span>)
    <span class="ruby-identifier">srcs</span> = <span class="ruby-identifier">$objs</span>.<span class="ruby-identifier">collect</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">obj</span><span class="ruby-operator">|</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/\.o\z/</span>, <span class="ruby-value str">'.c'</span>)}
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-identifier">$srcs</span> = <span class="ruby-identifier">srcs</span>
  <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">i</span> <span class="ruby-keyword kw">in</span> <span class="ruby-identifier">$objs</span>
    <span class="ruby-identifier">i</span>.<span class="ruby-identifier">sub!</span>(<span class="ruby-regexp re">/\.o\z/</span>, <span class="ruby-node">&quot;.#{$OBJEXT}&quot;</span>)
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-identifier">$objs</span> = <span class="ruby-identifier">$objs</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot; &quot;</span>)

  <span class="ruby-identifier">target</span> = <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$objs</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;&quot;</span>

  <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">target</span> <span class="ruby-keyword kw">and</span> <span class="ruby-constant">EXPORT_PREFIX</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">srcdir</span>, <span class="ruby-identifier">target</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'.def'</span>))
      <span class="ruby-identifier">deffile</span> = <span class="ruby-value str">&quot;$(srcdir)/$(TARGET).def&quot;</span>
      <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">EXPORT_PREFIX</span>.<span class="ruby-identifier">empty?</span>
        <span class="ruby-identifier">makedef</span> = <span class="ruby-node">%{-pe &quot;sub!(/^(?=\\w)/,'#{EXPORT_PREFIX}') unless 1../^EXPORTS$/i&quot;}</span>
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">else</span>
      <span class="ruby-identifier">makedef</span> = <span class="ruby-node">%{-e &quot;puts 'EXPORTS', '#{EXPORT_PREFIX}Init_$(TARGET)'&quot;}</span>
    <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">makedef</span>
      <span class="ruby-identifier">$distcleanfiles</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">'$(DEFFILE)'</span>
      <span class="ruby-identifier">origdef</span> = <span class="ruby-identifier">deffile</span>
      <span class="ruby-identifier">deffile</span> = <span class="ruby-value str">&quot;$(TARGET)-$(arch).def&quot;</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-identifier">origdef</span> <span class="ruby-operator">||=</span> <span class="ruby-value str">''</span>

  <span class="ruby-identifier">libpath</span> = <span class="ruby-identifier">libpathflag</span>(<span class="ruby-identifier">libpath</span>)

  <span class="ruby-identifier">dllib</span> = <span class="ruby-identifier">target</span> <span class="ruby-value">? </span><span class="ruby-node">&quot;$(TARGET).#{CONFIG['DLEXT']}&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-value str">&quot;&quot;</span>
  <span class="ruby-identifier">staticlib</span> = <span class="ruby-identifier">target</span> <span class="ruby-value">? </span><span class="ruby-value str">&quot;$(TARGET).#$LIBEXT&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-value str">&quot;&quot;</span>
  <span class="ruby-identifier">mfile</span> = <span class="ruby-identifier">open</span>(<span class="ruby-value str">&quot;Makefile&quot;</span>, <span class="ruby-value str">&quot;wb&quot;</span>)
  <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-identifier">configuration</span>(<span class="ruby-identifier">srcprefix</span>)
  <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-node">&quot;
libpath = #{($DEFLIBPATH|$LIBPATH).join(&quot; &quot;)}
LIBPATH = #{libpath}
DEFFILE = #{deffile}

CLEANFILES = #{$cleanfiles.join(' ')}
DISTCLEANFILES = #{$distcleanfiles.join(' ')}

extout = #{$extout}
extout_prefix = #{$extout_prefix}
target_prefix = #{target_prefix}
LOCAL_LIBS = #{$LOCAL_LIBS}
LIBS = #{$LIBRUBYARG} #{$libs} #{$LIBS}
SRCS = #{srcs.collect(&amp;File.method(:basename)).join(' ')}
OBJS = #{$objs}
TARGET = #{target}
DLLIB = #{dllib}
EXTSTATIC = #{$static || &quot;&quot;}
STATIC_LIB = #{staticlib unless $static.nil?}
#{!$extout &amp;&amp; defined?($installed_list) ? &quot;INSTALLED_LIST = #{$installed_list}\n&quot; : &quot;&quot;}
&quot;</span>
  <span class="ruby-identifier">install_dirs</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">d</span><span class="ruby-operator">|</span> <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span>(<span class="ruby-value str">&quot;%-14s= %s\n&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">d</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-regexp re">/^[[:upper:]]/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">d</span>[<span class="ruby-value">0</span>]}
  <span class="ruby-identifier">n</span> = (<span class="ruby-identifier">$extout</span> <span class="ruby-operator">?</span> <span class="ruby-value str">'$(RUBYARCHDIR)/'</span> <span class="ruby-operator">:</span> <span class="ruby-value str">''</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">'$(TARGET).'</span>
  <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-node">&quot;
TARGET_SO     = #{($extout ? '$(RUBYARCHDIR)/' : '')}$(DLLIB)
CLEANLIBS     = #{n}#{CONFIG['DLEXT']} #{n}il? #{n}tds #{n}map
CLEANOBJS     = *.#{$OBJEXT} *.#{$LIBEXT} *.s[ol] *.pdb *.exp *.bak

all:            #{$extout ? &quot;install&quot; : target ? &quot;$(DLLIB)&quot; : &quot;Makefile&quot;}
static:         $(STATIC_LIB)#{$extout ? &quot; install-rb&quot; : &quot;&quot;}
&quot;</span>
  <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-constant">CLEANINGS</span>
  <span class="ruby-identifier">dirs</span> = []
  <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;install: install-so install-rb\n\n&quot;</span>
  <span class="ruby-identifier">sodir</span> = (<span class="ruby-identifier">dir</span> = <span class="ruby-value str">&quot;$(RUBYARCHDIR)&quot;</span>).<span class="ruby-identifier">dup</span>
  <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span>(<span class="ruby-node">&quot;install-so: #{dir}\n&quot;</span>)
  <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">target</span>
    <span class="ruby-identifier">f</span> = <span class="ruby-value str">&quot;$(DLLIB)&quot;</span>
    <span class="ruby-identifier">dest</span> = <span class="ruby-node">&quot;#{dir}/#{f}&quot;</span>
    <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-node">&quot;install-so: #{dest}\n&quot;</span>
    <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">$extout</span>
      <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-node">&quot;#{dest}: #{f}\n&quot;</span>
      <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">sep</span> = <span class="ruby-identifier">config_string</span>(<span class="ruby-value str">'BUILD_FILE_SEPARATOR'</span>))
        <span class="ruby-identifier">f</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-value str">&quot;/&quot;</span>, <span class="ruby-identifier">sep</span>)
        <span class="ruby-identifier">dir</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-value str">&quot;/&quot;</span>, <span class="ruby-identifier">sep</span>)
        <span class="ruby-identifier">sep</span> = <span class="ruby-value str">&quot;:/=&quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">sep</span>
        <span class="ruby-identifier">f</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/(\$\(\w+)(\))/</span>) {<span class="ruby-identifier">$1</span><span class="ruby-operator">+</span><span class="ruby-identifier">sep</span><span class="ruby-operator">+</span><span class="ruby-identifier">$2</span>}
        <span class="ruby-identifier">f</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/(\$\{\w+)(\})/</span>) {<span class="ruby-identifier">$1</span><span class="ruby-operator">+</span><span class="ruby-identifier">sep</span><span class="ruby-operator">+</span><span class="ruby-identifier">$2</span>}
        <span class="ruby-identifier">dir</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/(\$\(\w+)(\))/</span>) {<span class="ruby-identifier">$1</span><span class="ruby-operator">+</span><span class="ruby-identifier">sep</span><span class="ruby-operator">+</span><span class="ruby-identifier">$2</span>}
        <span class="ruby-identifier">dir</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/(\$\{\w+)(\})/</span>) {<span class="ruby-identifier">$1</span><span class="ruby-operator">+</span><span class="ruby-identifier">sep</span><span class="ruby-operator">+</span><span class="ruby-identifier">$2</span>}
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-node">&quot;\t$(INSTALL_PROG) #{f} #{dir}\n&quot;</span>
      <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">defined?</span>(<span class="ruby-identifier">$installed_list</span>)
        <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-node">&quot;\t@echo #{dir}/#{File.basename(f)}&gt;&gt;$(INSTALLED_LIST)\n&quot;</span>
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span>(<span class="ruby-value str">&quot;install-rb: pre-install-rb install-rb-default\n&quot;</span>)
  <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span>(<span class="ruby-value str">&quot;install-rb-default: pre-install-rb-default\n&quot;</span>)
  <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span>(<span class="ruby-value str">&quot;pre-install-rb: Makefile\n&quot;</span>)
  <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span>(<span class="ruby-value str">&quot;pre-install-rb-default: Makefile\n&quot;</span>)
  <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">sfx</span>, <span class="ruby-identifier">i</span> <span class="ruby-keyword kw">in</span> [[<span class="ruby-value str">&quot;-default&quot;</span>, [[<span class="ruby-value str">&quot;lib/**/*.rb&quot;</span>, <span class="ruby-value str">&quot;$(RUBYLIBDIR)&quot;</span>, <span class="ruby-value str">&quot;lib&quot;</span>]]], [<span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-identifier">$INSTALLFILES</span>]]
    <span class="ruby-identifier">files</span> = <span class="ruby-identifier">install_files</span>(<span class="ruby-identifier">mfile</span>, <span class="ruby-identifier">i</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">srcprefix</span>) <span class="ruby-keyword kw">or</span> <span class="ruby-keyword kw">next</span>
    <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">dir</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">files</span> <span class="ruby-keyword kw">in</span> <span class="ruby-identifier">files</span>
      <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">dirs</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">dir</span>)
        <span class="ruby-identifier">dirs</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">dir</span>
        <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-node">&quot;pre-install-rb#{sfx}: #{dir}\n&quot;</span>
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-identifier">files</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">dest</span> = <span class="ruby-node">&quot;#{dir}/#{File.basename(f)}&quot;</span>
        <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span>(<span class="ruby-node">&quot;install-rb#{sfx}: #{dest}\n&quot;</span>)
        <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span>(<span class="ruby-node">&quot;#{dest}: #{f}\n\t$(#{$extout ? 'COPY' : 'INSTALL_DATA'}) &quot;</span>)
        <span class="ruby-identifier">sep</span> = <span class="ruby-identifier">config_string</span>(<span class="ruby-value str">'BUILD_FILE_SEPARATOR'</span>)
        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">sep</span>
          <span class="ruby-identifier">f</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-value str">&quot;/&quot;</span>, <span class="ruby-identifier">sep</span>)
          <span class="ruby-identifier">sep</span> = <span class="ruby-value str">&quot;:/=&quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">sep</span>
          <span class="ruby-identifier">f</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/(\$\(\w+)(\))/</span>) {<span class="ruby-identifier">$1</span><span class="ruby-operator">+</span><span class="ruby-identifier">sep</span><span class="ruby-operator">+</span><span class="ruby-identifier">$2</span>}
          <span class="ruby-identifier">f</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/(\$\{\w+)(\})/</span>) {<span class="ruby-identifier">$1</span><span class="ruby-operator">+</span><span class="ruby-identifier">sep</span><span class="ruby-operator">+</span><span class="ruby-identifier">$2</span>}
        <span class="ruby-keyword kw">else</span>
          <span class="ruby-identifier">sep</span> = <span class="ruby-value str">&quot;&quot;</span>
        <span class="ruby-keyword kw">end</span>
        <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span>(<span class="ruby-node">&quot;#{f} $(@D#{sep})\n&quot;</span>)
        <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">defined?</span>(<span class="ruby-identifier">$installed_list</span>) <span class="ruby-keyword kw">and</span> <span class="ruby-operator">!</span><span class="ruby-identifier">$extout</span>
          <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span>(<span class="ruby-node">&quot;\t@echo #{dest}&gt;&gt;$(INSTALLED_LIST)\n&quot;</span>)
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-identifier">dirs</span>.<span class="ruby-identifier">unshift</span>(<span class="ruby-identifier">sodir</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">target</span> <span class="ruby-keyword kw">and</span> <span class="ruby-operator">!</span><span class="ruby-identifier">dirs</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">sodir</span>)
  <span class="ruby-identifier">dirs</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">dir</span><span class="ruby-operator">|</span> <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-node">&quot;#{dir}:\n\t$(MAKEDIRS) $@\n&quot;</span>}

  <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;\nsite-install: site-install-so site-install-rb\nsite-install-so: install-so\nsite-install-rb: install-rb\n\n&quot;</span>

  <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">target</span>

  <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">puts</span> <span class="ruby-constant">SRC_EXT</span>.<span class="ruby-identifier">collect</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">ext</span><span class="ruby-operator">|</span> <span class="ruby-node">&quot;.path.#{ext} = $(VPATH)&quot;</span>} <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$nmake</span> <span class="ruby-operator">==</span> <span class="ruby-value">?b</span>
  <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-node">&quot;.SUFFIXES: .#{SRC_EXT.join(' .')} .#{$OBJEXT}\n&quot;</span>
  <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;\n&quot;</span>

  <span class="ruby-constant">CXX_EXT</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ext</span><span class="ruby-operator">|</span>
    <span class="ruby-constant">COMPILE_RULES</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">rule</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">printf</span>(<span class="ruby-identifier">rule</span>, <span class="ruby-identifier">ext</span>, <span class="ruby-identifier">$OBJEXT</span>)
      <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">printf</span>(<span class="ruby-value str">&quot;\n\t%s\n\n&quot;</span>, <span class="ruby-constant">COMPILE_CXX</span>)
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-node">%w[c]</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ext</span><span class="ruby-operator">|</span>
    <span class="ruby-constant">COMPILE_RULES</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">rule</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">printf</span>(<span class="ruby-identifier">rule</span>, <span class="ruby-identifier">ext</span>, <span class="ruby-identifier">$OBJEXT</span>)
      <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">printf</span>(<span class="ruby-value str">&quot;\n\t%s\n\n&quot;</span>, <span class="ruby-constant">COMPILE_C</span>)
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>

  <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;$(RUBYARCHDIR)/&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$extout</span>
  <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;$(DLLIB): &quot;</span>
  <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;$(DEFFILE) &quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">makedef</span>
  <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;$(OBJS) Makefile\n&quot;</span>
  <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;\t@-$(RM) $@\n&quot;</span>
  <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;\t@-$(MAKEDIRS) $(@D)\n&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$extout</span>
  <span class="ruby-identifier">link_so</span> = <span class="ruby-constant">LINK_SO</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/^/</span>, <span class="ruby-value str">&quot;\t&quot;</span>)
  <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-identifier">link_so</span>, <span class="ruby-value str">&quot;\n\n&quot;</span>
  <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">$static</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;$(STATIC_LIB): $(OBJS)\n\t&quot;</span>
    <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-node">&quot;$(AR) #{config_string('ARFLAGS') || 'cru '}$@ $(OBJS)&quot;</span>
    <span class="ruby-identifier">config_string</span>(<span class="ruby-value str">'RANLIB'</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ranlib</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-node">&quot;\n\t@-#{ranlib} $(DLLIB) 2&gt; /dev/null || true&quot;</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;\n\n&quot;</span>
  <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">makedef</span>
    <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-node">&quot;$(DEFFILE): #{origdef}\n&quot;</span>
    <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-node">&quot;\t$(RUBY) #{makedef} #{origdef} &gt; $@\n\n&quot;</span>
  <span class="ruby-keyword kw">end</span>

  <span class="ruby-identifier">depend</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">srcdir</span>, <span class="ruby-value str">&quot;depend&quot;</span>)
  <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-identifier">depend</span>)
    <span class="ruby-identifier">suffixes</span> = []
    <span class="ruby-identifier">depout</span> = []
    <span class="ruby-identifier">open</span>(<span class="ruby-identifier">depend</span>, <span class="ruby-value str">&quot;r&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">dfile</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">printf</span> <span class="ruby-value str">&quot;###\n&quot;</span>
      <span class="ruby-identifier">cont</span> = <span class="ruby-identifier">implicit</span> = <span class="ruby-keyword kw">nil</span>
      <span class="ruby-identifier">impconv</span> = <span class="ruby-identifier">proc</span> <span class="ruby-keyword kw">do</span>
        <span class="ruby-constant">COMPILE_RULES</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">rule</span><span class="ruby-operator">|</span> <span class="ruby-identifier">depout</span> <span class="ruby-operator">&lt;&lt;</span> (<span class="ruby-identifier">rule</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">implicit</span>[<span class="ruby-value">0</span>]) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">implicit</span>[<span class="ruby-value">1</span>]}
        <span class="ruby-identifier">implicit</span> = <span class="ruby-keyword kw">nil</span>
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-identifier">ruleconv</span> = <span class="ruby-identifier">proc</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">implicit</span>
          <span class="ruby-keyword kw">if</span> <span class="ruby-regexp re">/\A\t/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
            <span class="ruby-identifier">implicit</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">line</span>
            <span class="ruby-keyword kw">next</span>
          <span class="ruby-keyword kw">else</span>
            <span class="ruby-identifier">impconv</span>[]
          <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">end</span>
        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">m</span> = <span class="ruby-regexp re">/\A\.(\w+)\.(\w+)(?:\s*:)/</span>.<span class="ruby-identifier">match</span>(<span class="ruby-identifier">line</span>)
          <span class="ruby-identifier">suffixes</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">m</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">m</span>[<span class="ruby-value">2</span>]
          <span class="ruby-identifier">implicit</span> = [[<span class="ruby-identifier">m</span>[<span class="ruby-value">1</span>], <span class="ruby-identifier">m</span>[<span class="ruby-value">2</span>]], [<span class="ruby-identifier">m</span>.<span class="ruby-identifier">post_match</span>]]
          <span class="ruby-keyword kw">next</span>
        <span class="ruby-keyword kw">elsif</span> <span class="ruby-constant">RULE_SUBST</span> <span class="ruby-keyword kw">and</span> <span class="ruby-regexp re">/\A(?!\s*\w+\s*=)[$\w][^#]*:/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
          <span class="ruby-identifier">line</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">%r&quot;(\s)(?!\.)([^$(){}+=:\s\/\\,]+)(?=\s|\z)&quot;</span>) {<span class="ruby-identifier">$1</span> <span class="ruby-operator">+</span> <span class="ruby-constant">RULE_SUBST</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">$2</span>}
        <span class="ruby-keyword kw">end</span>
        <span class="ruby-identifier">depout</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">line</span>
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">line</span> = <span class="ruby-identifier">dfile</span>.<span class="ruby-identifier">gets</span>()
        <span class="ruby-identifier">line</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/\.o\b/</span>, <span class="ruby-node">&quot;.#{$OBJEXT}&quot;</span>)
        <span class="ruby-identifier">line</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/\$\(hdrdir\)\/config.h/</span>, <span class="ruby-identifier">$config_h</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$config_h</span>
        <span class="ruby-keyword kw">if</span> <span class="ruby-regexp re">/(?:^|[^\\])(?:\\\\)*\\$/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
          (<span class="ruby-identifier">cont</span> <span class="ruby-operator">||=</span> []) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">line</span>
          <span class="ruby-keyword kw">next</span>
        <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">cont</span>
          <span class="ruby-identifier">line</span> = (<span class="ruby-identifier">cont</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">line</span>).<span class="ruby-identifier">join</span>
          <span class="ruby-identifier">cont</span> = <span class="ruby-keyword kw">nil</span>
        <span class="ruby-keyword kw">end</span>
        <span class="ruby-identifier">ruleconv</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">line</span>)
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">cont</span>
        <span class="ruby-identifier">ruleconv</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">cont</span>.<span class="ruby-identifier">join</span>)
      <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">implicit</span>
        <span class="ruby-identifier">impconv</span>.<span class="ruby-identifier">call</span>
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">suffixes</span>.<span class="ruby-identifier">empty?</span>
      <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;.SUFFIXES: .&quot;</span>, <span class="ruby-identifier">suffixes</span>.<span class="ruby-identifier">uniq</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot; .&quot;</span>), <span class="ruby-value str">&quot;\n\n&quot;</span>
    <span class="ruby-keyword kw">end</span>
    <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;$(OBJS): $(RUBY_EXTCONF_H)\n\n&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$extconf_h</span>
    <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-identifier">depout</span>
  <span class="ruby-keyword kw">else</span>
    <span class="ruby-identifier">headers</span> = <span class="ruby-node">%w[ruby.h defines.h]</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-constant">RULE_SUBST</span>
      <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">h</span><span class="ruby-operator">|</span> <span class="ruby-identifier">h</span>.<span class="ruby-identifier">sub!</span>(<span class="ruby-regexp re">/.*/</span>) {<span class="ruby-operator">|</span><span class="ruby-operator">*</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-constant">RULE_SUBST</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">m</span>}}
    <span class="ruby-keyword kw">end</span>
    <span class="ruby-identifier">headers</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">$config_h</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$config_h</span>
    <span class="ruby-identifier">headers</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;$(RUBY_EXTCONF_H)&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$extconf_h</span>
    <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;$(OBJS): &quot;</span>, <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">' '</span>), <span class="ruby-value str">&quot;\n&quot;</span>
  <span class="ruby-keyword kw">end</span>

  <span class="ruby-identifier">$makefile_created</span> = <span class="ruby-keyword kw">true</span>
<span class="ruby-keyword kw">ensure</span>
  <span class="ruby-identifier">mfile</span>.<span class="ruby-identifier">close</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">mfile</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000503" class="method-detail">
        <a name="M000503"></a>

        <div class="method-heading">
          <a href="#M000503" class="method-signature">
          <span class="method-name">create_tmpsrc</span><span class="method-args">(src) {|src| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000503-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000503-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 254</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create_tmpsrc</span>(<span class="ruby-identifier">src</span>)
  <span class="ruby-identifier">src</span> = <span class="ruby-keyword kw">yield</span>(<span class="ruby-identifier">src</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
  <span class="ruby-identifier">src</span> = <span class="ruby-identifier">src</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/[ \t]+$/</span>, <span class="ruby-value str">''</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/\A\n+|^\n+$/</span>, <span class="ruby-value str">''</span>).<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/[^\n]\z/</span>, <span class="ruby-value str">&quot;\\&amp;\n&quot;</span>)
  <span class="ruby-identifier">open</span>(<span class="ruby-constant">CONFTEST_C</span>, <span class="ruby-value str">&quot;wb&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">cfile</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">cfile</span>.<span class="ruby-identifier">print</span> <span class="ruby-identifier">src</span>
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-identifier">src</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000549" class="method-detail">
        <a name="M000549"></a>

        <div class="method-heading">
          <a href="#M000549" class="method-signature">
          <span class="method-name">dir_config</span><span class="method-args">(target, idefault=nil, ldefault=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets a <tt>target</tt> name that the user can then use to configure various
&#8216;with&#8217; options with on the command line by using that name. For
example, if the target is set to &quot;foo&quot;, then the user could use
the &#8212;with-foo-dir command line option.
</p>
<p>
You may pass along additional &#8216;include&#8217; or &#8216;lib&#8217;
defaults via the <tt>idefault</tt> and <tt>ldefault</tt> parameters,
respectively.
</p>
<p>
Note that <a href="mkmf_rb.html#M000549">dir_config</a> only adds to the
list of places to search for libraries and include files. It does not link
the libraries into your application.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000549-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000549-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 970</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">dir_config</span>(<span class="ruby-identifier">target</span>, <span class="ruby-identifier">idefault</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">ldefault</span>=<span class="ruby-keyword kw">nil</span>)
  <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">dir</span> = <span class="ruby-identifier">with_config</span>(<span class="ruby-identifier">target</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;-dir&quot;</span>, (<span class="ruby-identifier">idefault</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">ldefault</span>))
    <span class="ruby-identifier">defaults</span> = <span class="ruby-constant">Array</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">dir</span> <span class="ruby-value">? </span><span class="ruby-identifier">dir</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">dir</span>.<span class="ruby-identifier">split</span>(<span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">PATH_SEPARATOR</span>)
    <span class="ruby-identifier">idefault</span> = <span class="ruby-identifier">ldefault</span> = <span class="ruby-keyword kw">nil</span>
  <span class="ruby-keyword kw">end</span>

  <span class="ruby-identifier">idir</span> = <span class="ruby-identifier">with_config</span>(<span class="ruby-identifier">target</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;-include&quot;</span>, <span class="ruby-identifier">idefault</span>)
  <span class="ruby-identifier">$arg_config</span>.<span class="ruby-identifier">last</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">||=</span> <span class="ruby-node">&quot;${#{target}-dir}/include&quot;</span>
  <span class="ruby-identifier">ldir</span> = <span class="ruby-identifier">with_config</span>(<span class="ruby-identifier">target</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;-lib&quot;</span>, <span class="ruby-identifier">ldefault</span>)
  <span class="ruby-identifier">$arg_config</span>.<span class="ruby-identifier">last</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">||=</span> <span class="ruby-node">&quot;${#{target}-dir}/lib&quot;</span>

  <span class="ruby-identifier">idirs</span> = <span class="ruby-identifier">idir</span> <span class="ruby-value">? </span><span class="ruby-constant">Array</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">idir</span> <span class="ruby-value">? </span><span class="ruby-identifier">idir</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">idir</span>.<span class="ruby-identifier">split</span>(<span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">PATH_SEPARATOR</span>) <span class="ruby-operator">:</span> []
  <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">defaults</span>
    <span class="ruby-identifier">idirs</span>.<span class="ruby-identifier">concat</span>(<span class="ruby-identifier">defaults</span>.<span class="ruby-identifier">collect</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">dir</span><span class="ruby-operator">|</span> <span class="ruby-identifier">dir</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;/include&quot;</span>})
    <span class="ruby-identifier">idir</span> = ([<span class="ruby-identifier">idir</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">idirs</span>).<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">PATH_SEPARATOR</span>)
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">idirs</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-identifier">idirs</span>.<span class="ruby-identifier">collect!</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">dir</span><span class="ruby-operator">|</span> <span class="ruby-value str">&quot;-I&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">dir</span>}
    <span class="ruby-identifier">idirs</span> <span class="ruby-operator">-=</span> <span class="ruby-constant">Shellwords</span>.<span class="ruby-identifier">shellwords</span>(<span class="ruby-identifier">$CPPFLAGS</span>)
    <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">idirs</span>.<span class="ruby-identifier">empty?</span>
      <span class="ruby-identifier">$CPPFLAGS</span> = (<span class="ruby-identifier">idirs</span>.<span class="ruby-identifier">quote</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">$CPPFLAGS</span>).<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot; &quot;</span>)
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>

  <span class="ruby-identifier">ldirs</span> = <span class="ruby-identifier">ldir</span> <span class="ruby-value">? </span><span class="ruby-constant">Array</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">ldir</span> <span class="ruby-value">? </span><span class="ruby-identifier">ldir</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">ldir</span>.<span class="ruby-identifier">split</span>(<span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">PATH_SEPARATOR</span>) <span class="ruby-operator">:</span> []
  <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">defaults</span>
    <span class="ruby-identifier">ldirs</span>.<span class="ruby-identifier">concat</span>(<span class="ruby-identifier">defaults</span>.<span class="ruby-identifier">collect</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">dir</span><span class="ruby-operator">|</span> <span class="ruby-identifier">dir</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;/lib&quot;</span>})
    <span class="ruby-identifier">ldir</span> = ([<span class="ruby-identifier">ldir</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">ldirs</span>).<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">PATH_SEPARATOR</span>)
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-identifier">$LIBPATH</span> = <span class="ruby-identifier">ldirs</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">$LIBPATH</span>

  [<span class="ruby-identifier">idir</span>, <span class="ruby-identifier">ldir</span>]
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000494" class="method-detail">
        <a name="M000494"></a>

        <div class="method-heading">
          <a href="#M000494" class="method-signature">
          <span class="method-name">dir_re</span><span class="method-args">(dir)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000494-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000494-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 70</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">dir_re</span>(<span class="ruby-identifier">dir</span>)
  <span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'\$(?:\('</span><span class="ruby-operator">+</span><span class="ruby-identifier">dir</span><span class="ruby-operator">+</span><span class="ruby-value str">'\)|\{'</span><span class="ruby-operator">+</span><span class="ruby-identifier">dir</span><span class="ruby-operator">+</span><span class="ruby-value str">'\})(?:\$(?:\(target_prefix\)|\{target_prefix\}))?'</span>)
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000554" class="method-detail">
        <a name="M000554"></a>

        <div class="method-heading">
          <a href="#M000554" class="method-signature">
          <span class="method-name">dummy_makefile</span><span class="method-args">(srcdir)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000554-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000554-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 1138</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">dummy_makefile</span>(<span class="ruby-identifier">srcdir</span>)
  <span class="ruby-identifier">configuration</span>(<span class="ruby-identifier">srcdir</span>) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;CLEANFILES = \#{$cleanfiles.join(' ')}\nDISTCLEANFILES = \#{$distcleanfiles.join(' ')}\n\nall install static install-so install-rb: Makefile\n\n&quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">CLEANINGS</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000521" class="method-detail">
        <a name="M000521"></a>

        <div class="method-heading">
          <a href="#M000521" class="method-signature">
          <span class="method-name">egrep_cpp</span><span class="method-args">(pat, src, opt = &quot;&quot;, &amp;b)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000521-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000521-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 451</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">egrep_cpp</span>(<span class="ruby-identifier">pat</span>, <span class="ruby-identifier">src</span>, <span class="ruby-identifier">opt</span> = <span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
  <span class="ruby-identifier">src</span> = <span class="ruby-identifier">create_tmpsrc</span>(<span class="ruby-identifier">src</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
  <span class="ruby-identifier">xpopen</span>(<span class="ruby-identifier">cpp_command</span>(<span class="ruby-value str">''</span>, <span class="ruby-identifier">opt</span>)) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Regexp</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">pat</span>
      <span class="ruby-identifier">puts</span>(<span class="ruby-node">&quot;    ruby -ne 'print if #{pat.inspect}'&quot;</span>)
      <span class="ruby-identifier">f</span>.<span class="ruby-identifier">grep</span>(<span class="ruby-identifier">pat</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">l</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{f.lineno}: #{l}&quot;</span>
        <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span>
      }
      <span class="ruby-keyword kw">false</span>
    <span class="ruby-keyword kw">else</span>
      <span class="ruby-identifier">puts</span>(<span class="ruby-node">&quot;    egrep '#{pat}'&quot;</span>)
      <span class="ruby-keyword kw">begin</span>
        <span class="ruby-identifier">stdin</span> = <span class="ruby-identifier">$stdin</span>.<span class="ruby-identifier">dup</span>
        <span class="ruby-identifier">$stdin</span>.<span class="ruby-identifier">reopen</span>(<span class="ruby-identifier">f</span>)
        <span class="ruby-identifier">system</span>(<span class="ruby-value str">&quot;egrep&quot;</span>, <span class="ruby-identifier">pat</span>)
      <span class="ruby-keyword kw">ensure</span>
        <span class="ruby-identifier">$stdin</span>.<span class="ruby-identifier">reopen</span>(<span class="ruby-identifier">stdin</span>)
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
<span class="ruby-keyword kw">ensure</span>
  <span class="ruby-identifier">rm_f</span> <span class="ruby-value str">&quot;conftest*&quot;</span>
  <span class="ruby-identifier">log_src</span>(<span class="ruby-identifier">src</span>)
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000547" class="method-detail">
        <a name="M000547"></a>

        <div class="method-heading">
          <a href="#M000547" class="method-signature">
          <span class="method-name">enable_config</span><span class="method-args">(config, *defaults) {|config, *defaults| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000547-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000547-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 925</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">enable_config</span>(<span class="ruby-identifier">config</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">defaults</span>)
  <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">arg_config</span>(<span class="ruby-value str">&quot;--enable-&quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">config</span>)
    <span class="ruby-keyword kw">true</span>
  <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">arg_config</span>(<span class="ruby-value str">&quot;--disable-&quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">config</span>)
    <span class="ruby-keyword kw">false</span>
  <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">block_given?</span>
    <span class="ruby-keyword kw">yield</span>(<span class="ruby-identifier">config</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">defaults</span>)
  <span class="ruby-keyword kw">else</span>
    <span class="ruby-keyword kw">return</span> <span class="ruby-operator">*</span><span class="ruby-identifier">defaults</span>
  <span class="ruby-keyword kw">end</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000544" class="method-detail">
        <a name="M000544"></a>

        <div class="method-heading">
          <a href="#M000544" class="method-signature">
          <span class="method-name">find_executable</span><span class="method-args">(bin, path = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000544-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000544-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 892</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">find_executable</span>(<span class="ruby-identifier">bin</span>, <span class="ruby-identifier">path</span> = <span class="ruby-keyword kw">nil</span>)
  <span class="ruby-identifier">checking_for</span> <span class="ruby-identifier">checking_message</span>(<span class="ruby-identifier">bin</span>, <span class="ruby-identifier">path</span>) <span class="ruby-keyword kw">do</span>
    <span class="ruby-identifier">find_executable0</span>(<span class="ruby-identifier">bin</span>, <span class="ruby-identifier">path</span>)
  <span class="ruby-keyword kw">end</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000543" class="method-detail">
        <a name="M000543"></a>

        <div class="method-heading">
          <a href="#M000543" class="method-signature">
          <span class="method-name">find_executable0</span><span class="method-args">(bin, path = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000543-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000543-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 872</span>
<span class="ruby-keyword kw">def</span>  <span class="ruby-identifier">find_executable0</span><span class="ruby-identifier">find_executable0</span>(<span class="ruby-identifier">bin</span>, <span class="ruby-identifier">path</span> = <span class="ruby-keyword kw">nil</span>)
  <span class="ruby-identifier">ext</span> = <span class="ruby-identifier">config_string</span>(<span class="ruby-value str">'EXEEXT'</span>)
  <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-identifier">bin</span>) <span class="ruby-operator">==</span> <span class="ruby-identifier">bin</span>
    <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">bin</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">executable?</span>(<span class="ruby-identifier">bin</span>)
    <span class="ruby-identifier">ext</span> <span class="ruby-keyword kw">and</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">executable?</span>(<span class="ruby-identifier">file</span> = <span class="ruby-identifier">bin</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">ext</span>) <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">file</span>
    <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">path</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">ENV</span>[<span class="ruby-value str">'PATH'</span>]
    <span class="ruby-identifier">path</span> = <span class="ruby-identifier">path</span>.<span class="ruby-identifier">split</span>(<span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">PATH_SEPARATOR</span>)
  <span class="ruby-keyword kw">else</span>
    <span class="ruby-identifier">path</span> = <span class="ruby-node">%w[/usr/local/bin /usr/ucb /usr/bin /bin]</span>
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-identifier">file</span> = <span class="ruby-keyword kw">nil</span>
  <span class="ruby-identifier">path</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">dir</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">file</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">executable?</span>(<span class="ruby-identifier">file</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">dir</span>, <span class="ruby-identifier">bin</span>))
    <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">file</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ext</span> <span class="ruby-keyword kw">and</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">executable?</span>(<span class="ruby-identifier">file</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">ext</span>)
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">nil</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000536" class="method-detail">
        <a name="M000536"></a>

        <div class="method-heading">
          <a href="#M000536" class="method-signature">
          <span class="method-name">find_header</span><span class="method-args">(header, *paths)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Instructs mkmf to search for the given <tt>header</tt> in any of the
<tt>paths</tt> provided, and returns whether or not it was found in those
paths.
</p>
<p>
If the header is found then the path it was found on is added to the list
of included directories that are sent to the compiler (via the -I switch).
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000536-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000536-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 711</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">find_header</span>(<span class="ruby-identifier">header</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">paths</span>)
  <span class="ruby-identifier">header</span> = <span class="ruby-identifier">cpp_include</span>(<span class="ruby-identifier">header</span>)
  <span class="ruby-identifier">checking_for</span> <span class="ruby-identifier">header</span> <span class="ruby-keyword kw">do</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">try_cpp</span>(<span class="ruby-identifier">header</span>)
      <span class="ruby-keyword kw">true</span>
    <span class="ruby-keyword kw">else</span>
      <span class="ruby-identifier">found</span> = <span class="ruby-keyword kw">false</span>
      <span class="ruby-identifier">paths</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">dir</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">opt</span> = <span class="ruby-node">&quot;-I#{dir}&quot;</span>.<span class="ruby-identifier">quote</span>
        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">try_cpp</span>(<span class="ruby-identifier">header</span>, <span class="ruby-identifier">opt</span>)
          <span class="ruby-identifier">$INCFLAGS</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot; &quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opt</span>
          <span class="ruby-identifier">found</span> = <span class="ruby-keyword kw">true</span>
          <span class="ruby-keyword kw">break</span>
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-identifier">found</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000532" class="method-detail">
        <a name="M000532"></a>

        <div class="method-heading">
          <a href="#M000532" class="method-signature">
          <span class="method-name">find_library</span><span class="method-args">(lib, func, *paths, &amp;b)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns whether or not the entry point <tt>func</tt> can be found within
the library <tt>lib</tt> in one of the <tt>paths</tt> specified, where
<tt>paths</tt> is an array of strings. If <tt>func</tt> is nil , then the
main() function is used as the entry point.
</p>
<p>
If <tt>lib</tt> is found, then the path it was found on is added to the
list of library paths searched and linked against.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000532-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000532-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 627</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">find_library</span>(<span class="ruby-identifier">lib</span>, <span class="ruby-identifier">func</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">paths</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
  <span class="ruby-identifier">func</span> = <span class="ruby-value str">&quot;main&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">func</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">func</span>.<span class="ruby-identifier">empty?</span>
  <span class="ruby-identifier">lib</span> = <span class="ruby-identifier">with_config</span>(<span class="ruby-identifier">lib</span><span class="ruby-operator">+</span><span class="ruby-value str">'lib'</span>, <span class="ruby-identifier">lib</span>)
  <span class="ruby-identifier">paths</span> = <span class="ruby-identifier">paths</span>.<span class="ruby-identifier">collect</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">path</span><span class="ruby-operator">|</span> <span class="ruby-identifier">path</span>.<span class="ruby-identifier">split</span>(<span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">PATH_SEPARATOR</span>)}.<span class="ruby-identifier">flatten</span>
  <span class="ruby-identifier">checking_for</span> <span class="ruby-node">&quot;#{func}() in #{LIBARG%lib}&quot;</span> <span class="ruby-keyword kw">do</span>
    <span class="ruby-identifier">libpath</span> = <span class="ruby-identifier">$LIBPATH</span>
    <span class="ruby-identifier">libs</span> = <span class="ruby-identifier">append_library</span>(<span class="ruby-identifier">$libs</span>, <span class="ruby-identifier">lib</span>)
    <span class="ruby-keyword kw">begin</span>
      <span class="ruby-keyword kw">until</span> <span class="ruby-identifier">r</span> = <span class="ruby-identifier">try_func</span>(<span class="ruby-identifier">func</span>, <span class="ruby-identifier">libs</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>) <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">paths</span>.<span class="ruby-identifier">empty?</span>
        <span class="ruby-identifier">$LIBPATH</span> = <span class="ruby-identifier">libpath</span> <span class="ruby-operator">|</span> [<span class="ruby-identifier">paths</span>.<span class="ruby-identifier">shift</span>]
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">r</span>
        <span class="ruby-identifier">$libs</span> = <span class="ruby-identifier">libs</span>
        <span class="ruby-identifier">libpath</span> = <span class="ruby-keyword kw">nil</span>
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">ensure</span>
      <span class="ruby-identifier">$LIBPATH</span> = <span class="ruby-identifier">libpath</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">libpath</span>
    <span class="ruby-keyword kw">end</span>
    <span class="ruby-identifier">r</span>
  <span class="ruby-keyword kw">end</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000533" class="method-detail">
        <a name="M000533"></a>

        <div class="method-heading">
          <a href="#M000533" class="method-signature">
          <span class="method-name">have_func</span><span class="method-args">(func, headers = nil, &amp;b)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns whether or not the function <tt>func</tt> can be found in the
common header files, or within any <tt>headers</tt> that you provide. If
found, a macro is passed as a preprocessor constant to the compiler using
the function name, in uppercase, prepended with &#8216;HAVE_&#8217;.
</p>
<p>
For example, if <a
href="mkmf_rb.html#M000533">have_func</a>(&#8216;foo&#8217;) returned true,
then the HAVE_FOO preprocessor macro would be passed to the compiler.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000533-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000533-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 657</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">have_func</span>(<span class="ruby-identifier">func</span>, <span class="ruby-identifier">headers</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
  <span class="ruby-identifier">checking_for</span> <span class="ruby-identifier">checking_message</span>(<span class="ruby-node">&quot;#{func}()&quot;</span>, <span class="ruby-identifier">headers</span>) <span class="ruby-keyword kw">do</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">try_func</span>(<span class="ruby-identifier">func</span>, <span class="ruby-identifier">$libs</span>, <span class="ruby-identifier">headers</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
      <span class="ruby-identifier">$defs</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">format</span>(<span class="ruby-value str">&quot;-DHAVE_%s&quot;</span>, <span class="ruby-identifier">func</span>.<span class="ruby-identifier">upcase</span>))
      <span class="ruby-keyword kw">true</span>
    <span class="ruby-keyword kw">else</span>
      <span class="ruby-keyword kw">false</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000535" class="method-detail">
        <a name="M000535"></a>

        <div class="method-heading">
          <a href="#M000535" class="method-signature">
          <span class="method-name">have_header</span><span class="method-args">(header, &amp;b)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns whether or not the given <tt>header</tt> file can be found on your
system. If found, a macro is passed as a preprocessor constant to the
compiler using the header file name, in uppercase, prepended with
&#8216;HAVE_&#8217;.
</p>
<p>
For example, if <a
href="mkmf_rb.html#M000535">have_header</a>(&#8216;foo.h&#8217;) returned
true, then the HAVE_FOO_H preprocessor macro would be passed to the
compiler.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000535-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000535-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 694</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">have_header</span>(<span class="ruby-identifier">header</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
  <span class="ruby-identifier">checking_for</span> <span class="ruby-identifier">header</span> <span class="ruby-keyword kw">do</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">try_cpp</span>(<span class="ruby-identifier">cpp_include</span>(<span class="ruby-identifier">header</span>), <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
      <span class="ruby-identifier">$defs</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">format</span>(<span class="ruby-value str">&quot;-DHAVE_%s&quot;</span>, <span class="ruby-identifier">header</span>.<span class="ruby-identifier">tr</span>(<span class="ruby-value str">&quot;a-z./\055&quot;</span>, <span class="ruby-value str">&quot;A-Z___&quot;</span>)))
      <span class="ruby-keyword kw">true</span>
    <span class="ruby-keyword kw">else</span>
      <span class="ruby-keyword kw">false</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000531" class="method-detail">
        <a name="M000531"></a>

        <div class="method-heading">
          <a href="#M000531" class="method-signature">
          <span class="method-name">have_library</span><span class="method-args">(lib, func = nil, headers = nil, &amp;b)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns whether or not the given entry point <tt>func</tt> can be found
within <tt>lib</tt>. If <tt>func</tt> is nil, the &#8216;main()&#8217;
entry point is used by default. If found, it adds the library to list of
libraries to be used when linking your extension.
</p>
<p>
If <tt>headers</tt> are provided, it will include those header files as the
header files it looks in when searching for <tt>func</tt>.
</p>
<p>
Real name of the library to be linked can be altered by
&#8217;&#8212;with-FOOlib&#8217; <a
href="mkmf_rb.html#M000553">configuration</a> option.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000531-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000531-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 602</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">have_library</span>(<span class="ruby-identifier">lib</span>, <span class="ruby-identifier">func</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">headers</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
  <span class="ruby-identifier">func</span> = <span class="ruby-value str">&quot;main&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">func</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">func</span>.<span class="ruby-identifier">empty?</span>
  <span class="ruby-identifier">lib</span> = <span class="ruby-identifier">with_config</span>(<span class="ruby-identifier">lib</span><span class="ruby-operator">+</span><span class="ruby-value str">'lib'</span>, <span class="ruby-identifier">lib</span>)
  <span class="ruby-identifier">checking_for</span> <span class="ruby-identifier">checking_message</span>(<span class="ruby-node">&quot;#{func}()&quot;</span>, <span class="ruby-constant">LIBARG</span><span class="ruby-operator">%</span><span class="ruby-identifier">lib</span>) <span class="ruby-keyword kw">do</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-constant">COMMON_LIBS</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">lib</span>)
      <span class="ruby-keyword kw">true</span>
    <span class="ruby-keyword kw">else</span>
      <span class="ruby-identifier">libs</span> = <span class="ruby-identifier">append_library</span>(<span class="ruby-identifier">$libs</span>, <span class="ruby-identifier">lib</span>)
      <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">try_func</span>(<span class="ruby-identifier">func</span>, <span class="ruby-identifier">libs</span>, <span class="ruby-identifier">headers</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
        <span class="ruby-identifier">$libs</span> = <span class="ruby-identifier">libs</span>
        <span class="ruby-keyword kw">true</span>
      <span class="ruby-keyword kw">else</span>
        <span class="ruby-keyword kw">false</span>
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000530" class="method-detail">
        <a name="M000530"></a>

        <div class="method-heading">
          <a href="#M000530" class="method-signature">
          <span class="method-name">have_macro</span><span class="method-args">(macro, headers = nil, opt = &quot;&quot;, &amp;b)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns whether or not <tt>macro</tt> is defined either in the common
header files or within any <tt>headers</tt> you provide.
</p>
<p>
Any options you pass to <tt>opt</tt> are passed along to the compiler.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000530-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000530-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 585</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">have_macro</span>(<span class="ruby-identifier">macro</span>, <span class="ruby-identifier">headers</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">opt</span> = <span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
  <span class="ruby-identifier">checking_for</span> <span class="ruby-identifier">checking_message</span>(<span class="ruby-identifier">macro</span>, <span class="ruby-identifier">headers</span>, <span class="ruby-identifier">opt</span>) <span class="ruby-keyword kw">do</span>
    <span class="ruby-identifier">macro_defined?</span>(<span class="ruby-identifier">macro</span>, <span class="ruby-identifier">cpp_include</span>(<span class="ruby-identifier">headers</span>), <span class="ruby-identifier">opt</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
  <span class="ruby-keyword kw">end</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000537" class="method-detail">
        <a name="M000537"></a>

        <div class="method-heading">
          <a href="#M000537" class="method-signature">
          <span class="method-name">have_struct_member</span><span class="method-args">(type, member, headers = nil, &amp;b)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns whether or not the struct of type <tt>type</tt> contains
<tt>member</tt>. If it does not, or the struct type can&#8216;t be found,
then false is returned. You may optionally specify additional
<tt>headers</tt> in which to look for the struct (in addition to the common
header files).
</p>
<p>
If found, a macro is passed as a preprocessor constant to the compiler
using the member name, in uppercase, prepended with &#8216;HAVE_ST_&#8217;.
</p>
<p>
For example, if <a
href="mkmf_rb.html#M000537">have_struct_member</a>(&#8216;foo&#8217;,
&#8216;bar&#8217;) returned true, then the HAVE_ST_BAR preprocessor macro
would be passed to the compiler.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000537-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000537-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 742</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">have_struct_member</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">member</span>, <span class="ruby-identifier">headers</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
  <span class="ruby-identifier">checking_for</span> <span class="ruby-identifier">checking_message</span>(<span class="ruby-node">&quot;#{type}.#{member}&quot;</span>, <span class="ruby-identifier">headers</span>) <span class="ruby-keyword kw">do</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">try_compile</span>(<span class="ruby-value str">&quot;\#{COMMON_HEADERS}\n\#{cpp_include(headers)}\n/*top*/\nint main() { return 0; }\nint s = (char *)&amp;((\#{type}*)0)-&gt;\#{member} - (char *)0;\n&quot;</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
      <span class="ruby-identifier">$defs</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">format</span>(<span class="ruby-value str">&quot;-DHAVE_ST_%s&quot;</span>, <span class="ruby-identifier">member</span>.<span class="ruby-identifier">upcase</span>))
      <span class="ruby-keyword kw">true</span>
    <span class="ruby-keyword kw">else</span>
      <span class="ruby-keyword kw">false</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000538" class="method-detail">
        <a name="M000538"></a>

        <div class="method-heading">
          <a href="#M000538" class="method-signature">
          <span class="method-name">have_type</span><span class="method-args">(type, headers = nil, opt = &quot;&quot;, &amp;b)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns whether or not the static type <tt>type</tt> is defined. You may
optionally pass additional <tt>headers</tt> to check against in addition to
the common header files.
</p>
<p>
You may also pass additional flags to <tt>opt</tt> which are then passed
along to the compiler.
</p>
<p>
If found, a macro is passed as a preprocessor constant to the compiler
using the type name, in uppercase, prepended with &#8216;HAVE_TYPE_&#8217;.
</p>
<p>
For example, if <a
href="mkmf_rb.html#M000538">have_type</a>(&#8216;foo&#8217;) returned true,
then the HAVE_TYPE_FOO preprocessor macro would be passed to the compiler.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000538-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000538-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 773</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">have_type</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">headers</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">opt</span> = <span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
  <span class="ruby-identifier">checking_for</span> <span class="ruby-identifier">checking_message</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">headers</span>, <span class="ruby-identifier">opt</span>) <span class="ruby-keyword kw">do</span>
    <span class="ruby-identifier">headers</span> = <span class="ruby-identifier">cpp_include</span>(<span class="ruby-identifier">headers</span>)
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">try_compile</span>(<span class="ruby-value str">&quot;\#{COMMON_HEADERS}\n\#{headers}\n/*top*/\ntypedef \#{type} conftest_type;\nstatic conftest_type conftestval[sizeof(conftest_type)?1:-1];\n&quot;</span>, <span class="ruby-identifier">opt</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
      <span class="ruby-identifier">$defs</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">format</span>(<span class="ruby-value str">&quot;-DHAVE_TYPE_%s&quot;</span>, <span class="ruby-identifier">type</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">upcase</span>.<span class="ruby-identifier">tr_s</span>(<span class="ruby-value str">&quot;^A-Z0-9_&quot;</span>, <span class="ruby-value str">&quot;_&quot;</span>)))
      <span class="ruby-keyword kw">true</span>
    <span class="ruby-keyword kw">else</span>
      <span class="ruby-keyword kw">false</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000534" class="method-detail">
        <a name="M000534"></a>

        <div class="method-heading">
          <a href="#M000534" class="method-signature">
          <span class="method-name">have_var</span><span class="method-args">(var, headers = nil, &amp;b)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns whether or not the variable <tt>var</tt> can be found in the common
header files, or within any <tt>headers</tt> that you provide. If found, a
macro is passed as a preprocessor constant to the compiler using the
variable name, in uppercase, prepended with &#8216;HAVE_&#8217;.
</p>
<p>
For example, if <a
href="mkmf_rb.html#M000534">have_var</a>(&#8216;foo&#8217;) returned true,
then the HAVE_FOO preprocessor macro would be passed to the compiler.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000534-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000534-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 676</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">have_var</span>(<span class="ruby-identifier">var</span>, <span class="ruby-identifier">headers</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
  <span class="ruby-identifier">checking_for</span> <span class="ruby-identifier">checking_message</span>(<span class="ruby-identifier">var</span>, <span class="ruby-identifier">headers</span>) <span class="ruby-keyword kw">do</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">try_var</span>(<span class="ruby-identifier">var</span>, <span class="ruby-identifier">headers</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
      <span class="ruby-identifier">$defs</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">format</span>(<span class="ruby-value str">&quot;-DHAVE_%s&quot;</span>, <span class="ruby-identifier">var</span>.<span class="ruby-identifier">upcase</span>))
      <span class="ruby-keyword kw">true</span>
    <span class="ruby-keyword kw">else</span>
      <span class="ruby-keyword kw">false</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000556" class="method-detail">
        <a name="M000556"></a>

        <div class="method-heading">
          <a href="#M000556" class="method-signature">
          <span class="method-name">init_mkmf</span><span class="method-args">(config = CONFIG)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000556-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000556-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 1436</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">init_mkmf</span>(<span class="ruby-identifier">config</span> = <span class="ruby-constant">CONFIG</span>)
  <span class="ruby-identifier">$makefile_created</span> = <span class="ruby-keyword kw">false</span>
  <span class="ruby-identifier">$arg_config</span> = []
  <span class="ruby-identifier">$enable_shared</span> = <span class="ruby-identifier">config</span>[<span class="ruby-value str">'ENABLE_SHARED'</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'yes'</span>
  <span class="ruby-identifier">$defs</span> = []
  <span class="ruby-identifier">$extconf_h</span> = <span class="ruby-keyword kw">nil</span>
  <span class="ruby-identifier">$CFLAGS</span> = <span class="ruby-identifier">with_config</span>(<span class="ruby-value str">&quot;cflags&quot;</span>, <span class="ruby-identifier">arg_config</span>(<span class="ruby-value str">&quot;CFLAGS&quot;</span>, <span class="ruby-identifier">config</span>[<span class="ruby-value str">&quot;CFLAGS&quot;</span>])).<span class="ruby-identifier">dup</span>
  <span class="ruby-identifier">$ARCH_FLAG</span> = <span class="ruby-identifier">with_config</span>(<span class="ruby-value str">&quot;arch_flag&quot;</span>, <span class="ruby-identifier">arg_config</span>(<span class="ruby-value str">&quot;ARCH_FLAG&quot;</span>, <span class="ruby-identifier">config</span>[<span class="ruby-value str">&quot;ARCH_FLAG&quot;</span>])).<span class="ruby-identifier">dup</span>
  <span class="ruby-identifier">$CPPFLAGS</span> = <span class="ruby-identifier">with_config</span>(<span class="ruby-value str">&quot;cppflags&quot;</span>, <span class="ruby-identifier">arg_config</span>(<span class="ruby-value str">&quot;CPPFLAGS&quot;</span>, <span class="ruby-identifier">config</span>[<span class="ruby-value str">&quot;CPPFLAGS&quot;</span>])).<span class="ruby-identifier">dup</span>
  <span class="ruby-identifier">$LDFLAGS</span> = <span class="ruby-identifier">with_config</span>(<span class="ruby-value str">&quot;ldflags&quot;</span>, <span class="ruby-identifier">arg_config</span>(<span class="ruby-value str">&quot;LDFLAGS&quot;</span>, <span class="ruby-identifier">config</span>[<span class="ruby-value str">&quot;LDFLAGS&quot;</span>])).<span class="ruby-identifier">dup</span>
  <span class="ruby-identifier">$INCFLAGS</span> = <span class="ruby-value str">&quot;-I$(topdir) -I$(hdrdir) -I$(srcdir)&quot;</span>
  <span class="ruby-identifier">$DLDFLAGS</span> = <span class="ruby-identifier">with_config</span>(<span class="ruby-value str">&quot;dldflags&quot;</span>, <span class="ruby-identifier">arg_config</span>(<span class="ruby-value str">&quot;DLDFLAGS&quot;</span>, <span class="ruby-identifier">config</span>[<span class="ruby-value str">&quot;DLDFLAGS&quot;</span>])).<span class="ruby-identifier">dup</span>
  <span class="ruby-identifier">$LIBEXT</span> = <span class="ruby-identifier">config</span>[<span class="ruby-value str">'LIBEXT'</span>].<span class="ruby-identifier">dup</span>
  <span class="ruby-identifier">$OBJEXT</span> = <span class="ruby-identifier">config</span>[<span class="ruby-value str">&quot;OBJEXT&quot;</span>].<span class="ruby-identifier">dup</span>
  <span class="ruby-identifier">$LIBS</span> = <span class="ruby-node">&quot;#{config['LIBS']} #{config['DLDLIBS']}&quot;</span>
  <span class="ruby-identifier">$LIBRUBYARG</span> = <span class="ruby-value str">&quot;&quot;</span>
  <span class="ruby-identifier">$LIBRUBYARG_STATIC</span> = <span class="ruby-identifier">config</span>[<span class="ruby-value str">'LIBRUBYARG_STATIC'</span>]
  <span class="ruby-identifier">$LIBRUBYARG_SHARED</span> = <span class="ruby-identifier">config</span>[<span class="ruby-value str">'LIBRUBYARG_SHARED'</span>]
  <span class="ruby-identifier">$DEFLIBPATH</span> = <span class="ruby-identifier">$extmk</span> <span class="ruby-operator">?</span> [<span class="ruby-value str">&quot;$(topdir)&quot;</span>] <span class="ruby-operator">:</span> <span class="ruby-constant">CROSS_COMPILING</span> <span class="ruby-value">? </span>[] <span class="ruby-operator">:</span> [<span class="ruby-value str">&quot;$(libdir)&quot;</span>]
  <span class="ruby-identifier">$DEFLIBPATH</span>.<span class="ruby-identifier">unshift</span>(<span class="ruby-value str">&quot;.&quot;</span>)
  <span class="ruby-identifier">$LIBPATH</span> = []
  <span class="ruby-identifier">$INSTALLFILES</span> = <span class="ruby-keyword kw">nil</span>

  <span class="ruby-identifier">$objs</span> = <span class="ruby-keyword kw">nil</span>
  <span class="ruby-identifier">$srcs</span> = <span class="ruby-keyword kw">nil</span>
  <span class="ruby-identifier">$libs</span> = <span class="ruby-value str">&quot;&quot;</span>
  <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$enable_shared</span> <span class="ruby-keyword kw">or</span> <span class="ruby-constant">Config</span>.<span class="ruby-identifier">expand</span>(<span class="ruby-identifier">config</span>[<span class="ruby-value str">&quot;LIBRUBY&quot;</span>].<span class="ruby-identifier">dup</span>) <span class="ruby-operator">!=</span> <span class="ruby-constant">Config</span>.<span class="ruby-identifier">expand</span>(<span class="ruby-identifier">config</span>[<span class="ruby-value str">&quot;LIBRUBY_A&quot;</span>].<span class="ruby-identifier">dup</span>)
    <span class="ruby-identifier">$LIBRUBYARG</span> = <span class="ruby-identifier">config</span>[<span class="ruby-value str">'LIBRUBYARG'</span>]
  <span class="ruby-keyword kw">end</span>

  <span class="ruby-identifier">$LOCAL_LIBS</span> = <span class="ruby-value str">&quot;&quot;</span>

  <span class="ruby-identifier">$cleanfiles</span> = <span class="ruby-identifier">config_string</span>(<span class="ruby-value str">'CLEANFILES'</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span> <span class="ruby-constant">Shellwords</span>.<span class="ruby-identifier">shellwords</span>(<span class="ruby-identifier">s</span>)} <span class="ruby-operator">||</span> []
  <span class="ruby-identifier">$cleanfiles</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;mkmf.log&quot;</span>
  <span class="ruby-identifier">$distcleanfiles</span> = <span class="ruby-identifier">config_string</span>(<span class="ruby-value str">'DISTCLEANFILES'</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span> <span class="ruby-constant">Shellwords</span>.<span class="ruby-identifier">shellwords</span>(<span class="ruby-identifier">s</span>)} <span class="ruby-operator">||</span> []

  <span class="ruby-identifier">$extout</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword kw">nil</span>
  <span class="ruby-identifier">$extout_prefix</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword kw">nil</span>

  <span class="ruby-identifier">$arg_config</span>.<span class="ruby-identifier">clear</span>
  <span class="ruby-identifier">dir_config</span>(<span class="ruby-value str">&quot;opt&quot;</span>)
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000495" class="method-detail">
        <a name="M000495"></a>

        <div class="method-heading">
          <a href="#M000495" class="method-signature">
          <span class="method-name">install_dirs</span><span class="method-args">(target_prefix = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000495-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000495-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 83</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">install_dirs</span>(<span class="ruby-identifier">target_prefix</span> = <span class="ruby-keyword kw">nil</span>)
  <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$extout</span>
    <span class="ruby-identifier">dirs</span> = [
      [<span class="ruby-value str">'RUBYCOMMONDIR'</span>, <span class="ruby-value str">'$(extout)/common'</span>],
      [<span class="ruby-value str">'RUBYLIBDIR'</span>,    <span class="ruby-value str">'$(RUBYCOMMONDIR)$(target_prefix)'</span>],
      [<span class="ruby-value str">'RUBYARCHDIR'</span>,   <span class="ruby-value str">'$(extout)/$(arch)$(target_prefix)'</span>],
      [<span class="ruby-value str">'extout'</span>,        <span class="ruby-value str">&quot;#$extout&quot;</span>],
      [<span class="ruby-value str">'extout_prefix'</span>, <span class="ruby-value str">&quot;#$extout_prefix&quot;</span>],
    ]
  <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">$extmk</span>
    <span class="ruby-identifier">dirs</span> = [
      [<span class="ruby-value str">'RUBYCOMMONDIR'</span>, <span class="ruby-value str">'$(rubylibdir)'</span>],
      [<span class="ruby-value str">'RUBYLIBDIR'</span>,    <span class="ruby-value str">'$(rubylibdir)$(target_prefix)'</span>],
      [<span class="ruby-value str">'RUBYARCHDIR'</span>,   <span class="ruby-value str">'$(archdir)$(target_prefix)'</span>],
    ]
  <span class="ruby-keyword kw">else</span>
    <span class="ruby-identifier">dirs</span> = [
      [<span class="ruby-value str">'RUBYCOMMONDIR'</span>, <span class="ruby-value str">'$(sitedir)$(target_prefix)'</span>],
      [<span class="ruby-value str">'RUBYLIBDIR'</span>,    <span class="ruby-value str">'$(sitelibdir)$(target_prefix)'</span>],
      [<span class="ruby-value str">'RUBYARCHDIR'</span>,   <span class="ruby-value str">'$(sitearchdir)$(target_prefix)'</span>],
    ]
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-identifier">dirs</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-value str">'target_prefix'</span>, (<span class="ruby-identifier">target_prefix</span> <span class="ruby-value">? </span><span class="ruby-node">&quot;/#{target_prefix}&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-value str">&quot;&quot;</span>)]
  <span class="ruby-identifier">dirs</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000524" class="method-detail">
        <a name="M000524"></a>

        <div class="method-heading">
          <a href="#M000524" class="method-signature">
          <span class="method-name">install_files</span><span class="method-args">(mfile, ifiles, map = nil, srcprefix = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000524-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000524-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 499</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">install_files</span>(<span class="ruby-identifier">mfile</span>, <span class="ruby-identifier">ifiles</span>, <span class="ruby-identifier">map</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">srcprefix</span> = <span class="ruby-keyword kw">nil</span>)
  <span class="ruby-identifier">ifiles</span> <span class="ruby-keyword kw">or</span> <span class="ruby-keyword kw">return</span>
  <span class="ruby-identifier">srcprefix</span> <span class="ruby-operator">||=</span> <span class="ruby-value str">'$(srcdir)'</span>
  <span class="ruby-constant">Config</span><span class="ruby-operator">::</span><span class="ruby-identifier">expand</span>(<span class="ruby-identifier">srcdir</span> = <span class="ruby-identifier">srcprefix</span>.<span class="ruby-identifier">dup</span>)
  <span class="ruby-identifier">dirs</span> = []
  <span class="ruby-identifier">path</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">h</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">h</span>[<span class="ruby-identifier">i</span>] = <span class="ruby-identifier">dirs</span>.<span class="ruby-identifier">push</span>([<span class="ruby-identifier">i</span>])[<span class="ruby-value">-1</span>]}
  <span class="ruby-identifier">ifiles</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">files</span>, <span class="ruby-identifier">dir</span>, <span class="ruby-identifier">prefix</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">dir</span> = <span class="ruby-identifier">map_dir</span>(<span class="ruby-identifier">dir</span>, <span class="ruby-identifier">map</span>)
    <span class="ruby-identifier">prefix</span> = <span class="ruby-node">%r|\A#{Regexp.quote(prefix)}/?|</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">prefix</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-regexp re">/\A\.\//</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">files</span>
      <span class="ruby-comment cmt"># install files which are in current working directory.</span>
      <span class="ruby-identifier">files</span> = <span class="ruby-identifier">files</span>[<span class="ruby-value">2</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>]
      <span class="ruby-identifier">len</span> = <span class="ruby-keyword kw">nil</span>
    <span class="ruby-keyword kw">else</span>
      <span class="ruby-comment cmt"># install files which are under the $(srcdir).</span>
      <span class="ruby-identifier">files</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">srcdir</span>, <span class="ruby-identifier">files</span>)
      <span class="ruby-identifier">len</span> = <span class="ruby-identifier">srcdir</span>.<span class="ruby-identifier">size</span>
    <span class="ruby-keyword kw">end</span>
    <span class="ruby-identifier">f</span> = <span class="ruby-keyword kw">nil</span>
    <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">glob</span>(<span class="ruby-identifier">files</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">f</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-identifier">len</span>] = <span class="ruby-value str">&quot;&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">len</span>
      <span class="ruby-identifier">d</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-identifier">f</span>)
      <span class="ruby-identifier">d</span>.<span class="ruby-identifier">sub!</span>(<span class="ruby-identifier">prefix</span>, <span class="ruby-value str">&quot;&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">prefix</span>
      <span class="ruby-identifier">d</span> = (<span class="ruby-identifier">d</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">d</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;.&quot;</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">dir</span> <span class="ruby-operator">:</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">dir</span>, <span class="ruby-identifier">d</span>)
      <span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">srcprefix</span>, <span class="ruby-identifier">f</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">len</span>
      <span class="ruby-identifier">path</span>[<span class="ruby-identifier">d</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">f</span>
    <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">len</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">f</span>
      <span class="ruby-identifier">d</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-identifier">files</span>)
      <span class="ruby-identifier">d</span>.<span class="ruby-identifier">sub!</span>(<span class="ruby-identifier">prefix</span>, <span class="ruby-value str">&quot;&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">prefix</span>
      <span class="ruby-identifier">d</span> = (<span class="ruby-identifier">d</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">d</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;.&quot;</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">dir</span> <span class="ruby-operator">:</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">dir</span>, <span class="ruby-identifier">d</span>)
      <span class="ruby-identifier">path</span>[<span class="ruby-identifier">d</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">files</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-identifier">dirs</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000525" class="method-detail">
        <a name="M000525"></a>

        <div class="method-heading">
          <a href="#M000525" class="method-signature">
          <span class="method-name">install_rb</span><span class="method-args">(mfile, dest, srcdir = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000525-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000525-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 536</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">install_rb</span>(<span class="ruby-identifier">mfile</span>, <span class="ruby-identifier">dest</span>, <span class="ruby-identifier">srcdir</span> = <span class="ruby-keyword kw">nil</span>)
  <span class="ruby-identifier">install_files</span>(<span class="ruby-identifier">mfile</span>, [[<span class="ruby-value str">&quot;lib/**/*.rb&quot;</span>, <span class="ruby-identifier">dest</span>, <span class="ruby-value str">&quot;lib&quot;</span>]], <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">srcdir</span>)
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000508" class="method-detail">
        <a name="M000508"></a>

        <div class="method-heading">
          <a href="#M000508" class="method-signature">
          <span class="method-name">libpathflag</span><span class="method-args">(libpath=$DEFLIBPATH|$LIBPATH)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000508-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000508-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 296</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">libpathflag</span>(<span class="ruby-identifier">libpath</span>=<span class="ruby-identifier">$DEFLIBPATH</span><span class="ruby-operator">|</span><span class="ruby-identifier">$LIBPATH</span>)
  <span class="ruby-identifier">libpath</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">x</span>
    <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;$(topdir)&quot;</span>, <span class="ruby-regexp re">/\A\./</span>
      <span class="ruby-constant">LIBPATHFLAG</span>
    <span class="ruby-keyword kw">else</span>
      <span class="ruby-constant">LIBPATHFLAG</span><span class="ruby-operator">+</span><span class="ruby-constant">RPATHFLAG</span>
    <span class="ruby-keyword kw">end</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">quote</span>
  }.<span class="ruby-identifier">join</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000505" class="method-detail">
        <a name="M000505"></a>

        <div class="method-heading">
          <a href="#M000505" class="method-signature">
          <span class="method-name">link_command</span><span class="method-args">(ldflags, opt=&quot;&quot;, libpath=$DEFLIBPATH|$LIBPATH)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000505-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000505-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 270</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">link_command</span>(<span class="ruby-identifier">ldflags</span>, <span class="ruby-identifier">opt</span>=<span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-identifier">libpath</span>=<span class="ruby-identifier">$DEFLIBPATH</span><span class="ruby-operator">|</span><span class="ruby-identifier">$LIBPATH</span>)
  <span class="ruby-identifier">conf</span> = <span class="ruby-constant">Config</span><span class="ruby-operator">::</span><span class="ruby-constant">CONFIG</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value str">'hdrdir'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">$hdrdir</span>.<span class="ruby-identifier">quote</span>,
                              <span class="ruby-value str">'src'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">CONFTEST_C</span>,
                              <span class="ruby-value str">'INCFLAGS'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">$INCFLAGS</span>,
                              <span class="ruby-value str">'CPPFLAGS'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">$CPPFLAGS</span>,
                              <span class="ruby-value str">'CFLAGS'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;#$CFLAGS&quot;</span>,
                              <span class="ruby-value str">'ARCH_FLAG'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;#$ARCH_FLAG&quot;</span>,
                              <span class="ruby-value str">'LDFLAGS'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#$LDFLAGS #{ldflags}&quot;</span>,
                              <span class="ruby-value str">'LIBPATH'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">libpathflag</span>(<span class="ruby-identifier">libpath</span>),
                              <span class="ruby-value str">'LOCAL_LIBS'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;#$LOCAL_LIBS #$libs&quot;</span>,
                              <span class="ruby-value str">'LIBS'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#$LIBRUBYARG_STATIC #{opt} #$LIBS&quot;</span>)
  <span class="ruby-constant">Config</span><span class="ruby-operator">::</span><span class="ruby-identifier">expand</span>(<span class="ruby-constant">TRY_LINK</span>.<span class="ruby-identifier">dup</span>, <span class="ruby-identifier">conf</span>)
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000502" class="method-detail">
        <a name="M000502"></a>

        <div class="method-heading">
          <a href="#M000502" class="method-signature">
          <span class="method-name">log_src</span><span class="method-args">(src)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000502-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000502-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 238</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">log_src</span>(<span class="ruby-identifier">src</span>)
  <span class="ruby-identifier">src</span> = <span class="ruby-identifier">src</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp re">/^/</span>)
  <span class="ruby-identifier">fmt</span> = <span class="ruby-node">&quot;%#{src.size.to_s.size}d: %s&quot;</span>
  <span class="ruby-constant">Logging</span><span class="ruby-operator">::</span><span class="ruby-identifier">message</span> <span class="ruby-value str">&quot;checked program was:\n/* begin */\n&quot;</span>
  <span class="ruby-identifier">src</span>.<span class="ruby-identifier">each_with_index</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">line</span>, <span class="ruby-identifier">no</span><span class="ruby-operator">|</span> <span class="ruby-constant">Logging</span><span class="ruby-operator">::</span><span class="ruby-identifier">message</span> <span class="ruby-identifier">fmt</span>, <span class="ruby-identifier">no</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>, <span class="ruby-identifier">line</span>}
  <span class="ruby-constant">Logging</span><span class="ruby-operator">::</span><span class="ruby-identifier">message</span> <span class="ruby-value str">&quot;/* end */\n\n&quot;</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000522" class="method-detail">
        <a name="M000522"></a>

        <div class="method-heading">
          <a href="#M000522" class="method-signature">
          <span class="method-name">macro_defined?</span><span class="method-args">(macro, src, opt = &quot;&quot;, &amp;b)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000522-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000522-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 477</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">macro_defined?</span>(<span class="ruby-identifier">macro</span>, <span class="ruby-identifier">src</span>, <span class="ruby-identifier">opt</span> = <span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
  <span class="ruby-identifier">src</span> = <span class="ruby-identifier">src</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/[^\n]\z/</span>, <span class="ruby-value str">&quot;\\&amp;\n&quot;</span>)
  <span class="ruby-identifier">try_compile</span>(<span class="ruby-identifier">src</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;/*top*/\n#ifndef \#{macro}\n# error\n&gt;&gt;&gt;&gt;&gt;&gt; \#{macro} undefined &lt;&lt;&lt;&lt;&lt;&lt;\n#endif\n&quot;</span>, <span class="ruby-identifier">opt</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000496" class="method-detail">
        <a name="M000496"></a>

        <div class="method-heading">
          <a href="#M000496" class="method-signature">
          <span class="method-name">map_dir</span><span class="method-args">(dir, map = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000496-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000496-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 109</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">map_dir</span>(<span class="ruby-identifier">dir</span>, <span class="ruby-identifier">map</span> = <span class="ruby-keyword kw">nil</span>)
  <span class="ruby-identifier">map</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">INSTALL_DIRS</span>
  <span class="ruby-identifier">map</span>.<span class="ruby-identifier">inject</span>(<span class="ruby-identifier">dir</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">dir</span>, (<span class="ruby-identifier">orig</span>, <span class="ruby-identifier">new</span>)<span class="ruby-operator">|</span> <span class="ruby-identifier">dir</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-identifier">orig</span>, <span class="ruby-identifier">new</span>)}
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000499" class="method-detail">
        <a name="M000499"></a>

        <div class="method-heading">
          <a href="#M000499" class="method-signature">
          <span class="method-name">merge_libs</span><span class="method-args">(*libs)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000499-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000499-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 152</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">merge_libs</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">libs</span>)
  <span class="ruby-identifier">libs</span>.<span class="ruby-identifier">inject</span>([]) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">x</span>, <span class="ruby-identifier">y</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">xy</span> = <span class="ruby-identifier">x</span> <span class="ruby-operator">&amp;</span> <span class="ruby-identifier">y</span>
    <span class="ruby-identifier">xn</span> = <span class="ruby-identifier">yn</span> = <span class="ruby-value">0</span>
    <span class="ruby-identifier">y</span> = <span class="ruby-identifier">y</span>.<span class="ruby-identifier">inject</span>([]) {<span class="ruby-operator">|</span><span class="ruby-identifier">ary</span>, <span class="ruby-identifier">e</span><span class="ruby-operator">|</span> <span class="ruby-identifier">ary</span>.<span class="ruby-identifier">last</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">e</span> <span class="ruby-value">? </span><span class="ruby-identifier">ary</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">ary</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">e</span>}
    <span class="ruby-identifier">y</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">v</span>, <span class="ruby-identifier">yi</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">xy</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">v</span>)
        <span class="ruby-identifier">xi</span> = [<span class="ruby-identifier">x</span>.<span class="ruby-identifier">index</span>(<span class="ruby-identifier">v</span>), <span class="ruby-identifier">xn</span>].<span class="ruby-identifier">max</span>()
        <span class="ruby-identifier">x</span>[<span class="ruby-identifier">xi</span>, <span class="ruby-value">1</span>] = <span class="ruby-identifier">y</span>[<span class="ruby-identifier">yn</span><span class="ruby-operator">..</span><span class="ruby-identifier">yi</span>]
        <span class="ruby-identifier">xn</span>, <span class="ruby-identifier">yn</span> = <span class="ruby-identifier">xi</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">yi</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">yn</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>), <span class="ruby-identifier">yi</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
    <span class="ruby-identifier">x</span>.<span class="ruby-identifier">concat</span>(<span class="ruby-identifier">y</span>[<span class="ruby-identifier">yn</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>] <span class="ruby-operator">||</span> [])
  <span class="ruby-keyword kw">end</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000527" class="method-detail">
        <a name="M000527"></a>

        <div class="method-heading">
          <a href="#M000527" class="method-signature">
          <span class="method-name">message</span><span class="method-args">(*s)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000527-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000527-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 544</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">message</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">s</span>)
  <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">$extmk</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">not</span> <span class="ruby-identifier">$VERBOSE</span>
    <span class="ruby-identifier">printf</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">s</span>)
    <span class="ruby-identifier">$stdout</span>.<span class="ruby-identifier">flush</span>
  <span class="ruby-keyword kw">end</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000557" class="method-detail">
        <a name="M000557"></a>

        <div class="method-heading">
          <a href="#M000557" class="method-signature">
          <span class="method-name">mkmf_failed</span><span class="method-args">(path)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000557-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000557-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 1488</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">mkmf_failed</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">$makefile_created</span> <span class="ruby-keyword kw">or</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-value str">&quot;Makefile&quot;</span>)
    <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">$arg_config</span>.<span class="ruby-identifier">collect</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">t</span>, <span class="ruby-identifier">n</span><span class="ruby-operator">|</span> <span class="ruby-node">&quot;\t#{t}#{n ? &quot;=#{n}&quot; : &quot;&quot;}\n&quot;</span>}
    <span class="ruby-identifier">abort</span> <span class="ruby-node">&quot;*** #{path} failed ***\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-constant">FailedMessage</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">join</span>
  <span class="ruby-keyword kw">end</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000498" class="method-detail">
        <a name="M000498"></a>

        <div class="method-heading">
          <a href="#M000498" class="method-signature">
          <span class="method-name">modified?</span><span class="method-args">(target, times)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000498-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000498-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 146</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">modified?</span>(<span class="ruby-identifier">target</span>, <span class="ruby-identifier">times</span>)
  (<span class="ruby-identifier">t</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">mtime</span>(<span class="ruby-identifier">target</span>)) <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
  <span class="ruby-constant">Array</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">times</span> <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">times</span> = [<span class="ruby-identifier">times</span>]
  <span class="ruby-identifier">t</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">times</span>.<span class="ruby-identifier">all?</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">n</span><span class="ruby-operator">|</span> <span class="ruby-identifier">n</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">t</span>}
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000550" class="method-detail">
        <a name="M000550"></a>

        <div class="method-heading">
          <a href="#M000550" class="method-signature">
          <span class="method-name">pkg_config</span><span class="method-args">(pkg)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000550-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000550-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 1004</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">pkg_config</span>(<span class="ruby-identifier">pkg</span>)
  <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">pkgconfig</span> = <span class="ruby-identifier">with_config</span>(<span class="ruby-node">&quot;#{pkg}-config&quot;</span>) <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">find_executable0</span>(<span class="ruby-identifier">pkgconfig</span>)
    <span class="ruby-comment cmt"># iff package specific config command is given</span>
    <span class="ruby-identifier">get</span> = <span class="ruby-identifier">proc</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">opt</span><span class="ruby-operator">|</span> <span class="ruby-node">`#{pkgconfig} --#{opt}`</span>.<span class="ruby-identifier">chomp</span>}
  <span class="ruby-keyword kw">elsif</span> (<span class="ruby-identifier">$PKGCONFIG</span> <span class="ruby-operator">||=</span> 
         (<span class="ruby-identifier">pkgconfig</span> = <span class="ruby-identifier">with_config</span>(<span class="ruby-value str">&quot;pkg-config&quot;</span>, (<span class="ruby-value str">&quot;pkg-config&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">CROSS_COMPILING</span>))) <span class="ruby-operator">&amp;&amp;</span>
         <span class="ruby-identifier">find_executable0</span>(<span class="ruby-identifier">pkgconfig</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">pkgconfig</span>) <span class="ruby-keyword kw">and</span>
      <span class="ruby-identifier">system</span>(<span class="ruby-node">&quot;#{$PKGCONFIG} --exists #{pkg}&quot;</span>)
    <span class="ruby-comment cmt"># default to pkg-config command</span>
    <span class="ruby-identifier">get</span> = <span class="ruby-identifier">proc</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">opt</span><span class="ruby-operator">|</span> <span class="ruby-node">`#{$PKGCONFIG} --#{opt} #{pkg}`</span>.<span class="ruby-identifier">chomp</span>}
  <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">find_executable0</span>(<span class="ruby-identifier">pkgconfig</span> = <span class="ruby-node">&quot;#{pkg}-config&quot;</span>)
    <span class="ruby-comment cmt"># default to package specific config command, as a last resort.</span>
    <span class="ruby-identifier">get</span> = <span class="ruby-identifier">proc</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">opt</span><span class="ruby-operator">|</span> <span class="ruby-node">`#{pkgconfig} --#{opt}`</span>.<span class="ruby-identifier">chomp</span>}
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">get</span>
    <span class="ruby-identifier">cflags</span> = <span class="ruby-identifier">get</span>[<span class="ruby-value str">'cflags'</span>]
    <span class="ruby-identifier">ldflags</span> = <span class="ruby-identifier">get</span>[<span class="ruby-value str">'libs'</span>]
    <span class="ruby-identifier">libs</span> = <span class="ruby-identifier">get</span>[<span class="ruby-value str">'libs-only-l'</span>]
    <span class="ruby-identifier">ldflags</span> = (<span class="ruby-constant">Shellwords</span>.<span class="ruby-identifier">shellwords</span>(<span class="ruby-identifier">ldflags</span>) <span class="ruby-operator">-</span> <span class="ruby-constant">Shellwords</span>.<span class="ruby-identifier">shellwords</span>(<span class="ruby-identifier">libs</span>)).<span class="ruby-identifier">quote</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot; &quot;</span>)
    <span class="ruby-identifier">$CFLAGS</span> <span class="ruby-operator">+=</span> <span class="ruby-value str">&quot; &quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">cflags</span>
    <span class="ruby-identifier">$LDFLAGS</span> <span class="ruby-operator">+=</span> <span class="ruby-value str">&quot; &quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">ldflags</span>
    <span class="ruby-identifier">$libs</span> <span class="ruby-operator">+=</span> <span class="ruby-value str">&quot; &quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">libs</span>
    <span class="ruby-constant">Logging</span><span class="ruby-operator">::</span><span class="ruby-identifier">message</span> <span class="ruby-value str">&quot;package configuration for %s\n&quot;</span>, <span class="ruby-identifier">pkg</span>
    <span class="ruby-constant">Logging</span><span class="ruby-operator">::</span><span class="ruby-identifier">message</span> <span class="ruby-value str">&quot;cflags: %s\nldflags: %s\nlibs: %s\n\n&quot;</span>,
                     <span class="ruby-identifier">cflags</span>, <span class="ruby-identifier">ldflags</span>, <span class="ruby-identifier">libs</span>
    [<span class="ruby-identifier">cflags</span>, <span class="ruby-identifier">ldflags</span>, <span class="ruby-identifier">libs</span>]
  <span class="ruby-keyword kw">else</span>
    <span class="ruby-constant">Logging</span><span class="ruby-operator">::</span><span class="ruby-identifier">message</span> <span class="ruby-value str">&quot;package configuration for %s is not found\n&quot;</span>, <span class="ruby-identifier">pkg</span>
    <span class="ruby-keyword kw">nil</span>
  <span class="ruby-keyword kw">end</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000497" class="method-detail">
        <a name="M000497"></a>

        <div class="method-heading">
          <a href="#M000497" class="method-signature">
          <span class="method-name">rm_f</span><span class="method-args">(*files)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000497-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000497-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 142</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">rm_f</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">files</span>)
  <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm_f</span>(<span class="ruby-constant">Dir</span>[<span class="ruby-identifier">files</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\0&quot;</span>)])
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000540" class="method-detail">
        <a name="M000540"></a>

        <div class="method-heading">
          <a href="#M000540" class="method-signature">
          <span class="method-name">scalar_ptr_type?</span><span class="method-args">(type, member = nil, headers = nil, &amp;b)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000540-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000540-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 816</span>
<span class="ruby-keyword kw">def</span>  <span class="ruby-identifier">scalar_ptr_type?</span><span class="ruby-identifier">scalar_ptr_type?</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">member</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">headers</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
  <span class="ruby-identifier">try_compile</span>(<span class="ruby-value str">&quot;\#{COMMON_HEADERS}\n\#{cpp_include(headers)}\n/*top*/\nvolatile \#{type} conftestval;\nint main() { return 0; }\nint t() {return (int)(1-*(conftestval\#{member ? \&quot;.\#{member}\&quot; : \&quot;\&quot;}));}\n&quot;</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)   <span class="ruby-comment cmt"># pointer</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000541" class="method-detail">
        <a name="M000541"></a>

        <div class="method-heading">
          <a href="#M000541" class="method-signature">
          <span class="method-name">scalar_type?</span><span class="method-args">(type, member = nil, headers = nil, &amp;b)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000541-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000541-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 828</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">scalar_type?</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">member</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">headers</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
  <span class="ruby-identifier">try_compile</span>(<span class="ruby-value str">&quot;\#{COMMON_HEADERS}\n\#{cpp_include(headers)}\n/*top*/\nvolatile \#{type} conftestval;\nint main() { return 0; }\nint t() {return (int)(1-(conftestval\#{member ? \&quot;.\#{member}\&quot; : \&quot;\&quot;}));}\n&quot;</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)   <span class="ruby-comment cmt"># pointer</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000511" class="method-detail">
        <a name="M000511"></a>

        <div class="method-heading">
          <a href="#M000511" class="method-signature">
          <span class="method-name">try_compile</span><span class="method-args">(src, opt=&quot;&quot;, &amp;b)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000511-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000511-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 317</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">try_compile</span>(<span class="ruby-identifier">src</span>, <span class="ruby-identifier">opt</span>=<span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
  <span class="ruby-identifier">try_do</span>(<span class="ruby-identifier">src</span>, <span class="ruby-identifier">cc_command</span>(<span class="ruby-identifier">opt</span>), <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
<span class="ruby-keyword kw">ensure</span>
  <span class="ruby-identifier">rm_f</span> <span class="ruby-value str">&quot;conftest*&quot;</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000518" class="method-detail">
        <a name="M000518"></a>

        <div class="method-heading">
          <a href="#M000518" class="method-signature">
          <span class="method-name">try_constant</span><span class="method-args">(const, headers = nil, opt = &quot;&quot;, &amp;b)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000518-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000518-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 373</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">try_constant</span>(<span class="ruby-identifier">const</span>, <span class="ruby-identifier">headers</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">opt</span> = <span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
  <span class="ruby-identifier">includes</span> = <span class="ruby-identifier">cpp_include</span>(<span class="ruby-identifier">headers</span>)
  <span class="ruby-keyword kw">if</span> <span class="ruby-constant">CROSS_COMPILING</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">try_static_assert</span>(<span class="ruby-node">&quot;#{const} &gt; 0&quot;</span>, <span class="ruby-identifier">headers</span>, <span class="ruby-identifier">opt</span>)
      <span class="ruby-comment cmt"># positive constant</span>
    <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">try_static_assert</span>(<span class="ruby-node">&quot;#{const} &lt; 0&quot;</span>, <span class="ruby-identifier">headers</span>, <span class="ruby-identifier">opt</span>)
      <span class="ruby-identifier">neg</span> = <span class="ruby-keyword kw">true</span>
      <span class="ruby-identifier">const</span> = <span class="ruby-node">&quot;-(#{const})&quot;</span>
    <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">try_static_assert</span>(<span class="ruby-node">&quot;#{const} == 0&quot;</span>, <span class="ruby-identifier">headers</span>, <span class="ruby-identifier">opt</span>)
      <span class="ruby-keyword kw">return</span> <span class="ruby-value">0</span>
    <span class="ruby-keyword kw">else</span>
      <span class="ruby-comment cmt"># not a constant</span>
      <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
    <span class="ruby-keyword kw">end</span>
    <span class="ruby-identifier">upper</span> = <span class="ruby-value">1</span>
    <span class="ruby-identifier">lower</span> = <span class="ruby-value">0</span>
    <span class="ruby-keyword kw">until</span> <span class="ruby-identifier">try_static_assert</span>(<span class="ruby-node">&quot;#{const} &lt;= #{upper}&quot;</span>, <span class="ruby-identifier">headers</span>, <span class="ruby-identifier">opt</span>)
      <span class="ruby-identifier">lower</span> = <span class="ruby-identifier">upper</span>
      <span class="ruby-identifier">upper</span> <span class="ruby-operator">&lt;&lt;=</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">lower</span>
    <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">upper</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">lower</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
      <span class="ruby-identifier">mid</span> = (<span class="ruby-identifier">upper</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">lower</span>) <span class="ruby-operator">/</span> <span class="ruby-value">2</span>
      <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">try_static_assert</span>(<span class="ruby-node">&quot;#{const} &gt; #{mid}&quot;</span>, <span class="ruby-identifier">headers</span>, <span class="ruby-identifier">opt</span>)
        <span class="ruby-identifier">lower</span> = <span class="ruby-identifier">mid</span>
      <span class="ruby-keyword kw">else</span>
        <span class="ruby-identifier">upper</span> = <span class="ruby-identifier">mid</span>
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
    <span class="ruby-identifier">upper</span> = <span class="ruby-operator">-</span><span class="ruby-identifier">upper</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">neg</span>
    <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">upper</span>
  <span class="ruby-keyword kw">else</span>
    <span class="ruby-identifier">src</span> = <span class="ruby-node">%{#{COMMON_HEADERS}
#{includes}
#include &lt;stdio.h&gt;
/*top*/
int conftest_const = (int)(#{const});
int main() {printf(&quot;%d\\n&quot;, conftest_const); return 0;}
}</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">try_link0</span>(<span class="ruby-identifier">src</span>, <span class="ruby-identifier">opt</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
      <span class="ruby-identifier">xpopen</span>(<span class="ruby-value str">&quot;./conftest&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
        <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Integer</span>(<span class="ruby-identifier">f</span>.<span class="ruby-identifier">gets</span>)
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">nil</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000512" class="method-detail">
        <a name="M000512"></a>

        <div class="method-heading">
          <a href="#M000512" class="method-signature">
          <span class="method-name">try_cpp</span><span class="method-args">(src, opt=&quot;&quot;, &amp;b)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000512-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000512-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 323</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">try_cpp</span>(<span class="ruby-identifier">src</span>, <span class="ruby-identifier">opt</span>=<span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
  <span class="ruby-identifier">try_do</span>(<span class="ruby-identifier">src</span>, <span class="ruby-identifier">cpp_command</span>(<span class="ruby-constant">CPPOUTFILE</span>, <span class="ruby-identifier">opt</span>), <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
<span class="ruby-keyword kw">ensure</span>
  <span class="ruby-identifier">rm_f</span> <span class="ruby-value str">&quot;conftest*&quot;</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000504" class="method-detail">
        <a name="M000504"></a>

        <div class="method-heading">
          <a href="#M000504" class="method-signature">
          <span class="method-name">try_do</span><span class="method-args">(src, command, &amp;b)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000504-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000504-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 263</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">try_do</span>(<span class="ruby-identifier">src</span>, <span class="ruby-identifier">command</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
  <span class="ruby-identifier">src</span> = <span class="ruby-identifier">create_tmpsrc</span>(<span class="ruby-identifier">src</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
  <span class="ruby-identifier">xsystem</span>(<span class="ruby-identifier">command</span>)
<span class="ruby-keyword kw">ensure</span>
  <span class="ruby-identifier">log_src</span>(<span class="ruby-identifier">src</span>)
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000519" class="method-detail">
        <a name="M000519"></a>

        <div class="method-heading">
          <a href="#M000519" class="method-signature">
          <span class="method-name">try_func</span><span class="method-args">(func, libs, headers = nil, &amp;b)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000519-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000519-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 421</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">try_func</span>(<span class="ruby-identifier">func</span>, <span class="ruby-identifier">libs</span>, <span class="ruby-identifier">headers</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
  <span class="ruby-identifier">headers</span> = <span class="ruby-identifier">cpp_include</span>(<span class="ruby-identifier">headers</span>)
  <span class="ruby-identifier">try_link</span>(<span class="ruby-value str">&quot;\#{COMMON_HEADERS}\n\#{headers}\n/*top*/\nint main() { return 0; }\nint t() { void ((*volatile p)()); p = (void ((*)()))\#{func}; return 0; }\n&quot;</span>, <span class="ruby-identifier">libs</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>) <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">try_link</span>(<span class="ruby-value str">&quot;\#{headers}\n/*top*/\nint main() { return 0; }\nint t() { \#{func}(); return 0; }\n&quot;</span>, <span class="ruby-identifier">libs</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000510" class="method-detail">
        <a name="M000510"></a>

        <div class="method-heading">
          <a href="#M000510" class="method-signature">
          <span class="method-name">try_link</span><span class="method-args">(src, opt=&quot;&quot;, &amp;b)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000510-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000510-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 311</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">try_link</span>(<span class="ruby-identifier">src</span>, <span class="ruby-identifier">opt</span>=<span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
  <span class="ruby-identifier">try_link0</span>(<span class="ruby-identifier">src</span>, <span class="ruby-identifier">opt</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
<span class="ruby-keyword kw">ensure</span>
  <span class="ruby-identifier">rm_f</span> <span class="ruby-value str">&quot;conftest*&quot;</span>, <span class="ruby-value str">&quot;c0x32*&quot;</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000509" class="method-detail">
        <a name="M000509"></a>

        <div class="method-heading">
          <a href="#M000509" class="method-signature">
          <span class="method-name">try_link0</span><span class="method-args">(src, opt=&quot;&quot;, &amp;b)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000509-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000509-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 307</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">try_link0</span>(<span class="ruby-identifier">src</span>, <span class="ruby-identifier">opt</span>=<span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
  <span class="ruby-identifier">try_do</span>(<span class="ruby-identifier">src</span>, <span class="ruby-identifier">link_command</span>(<span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-identifier">opt</span>), <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000523" class="method-detail">
        <a name="M000523"></a>

        <div class="method-heading">
          <a href="#M000523" class="method-signature">
          <span class="method-name">try_run</span><span class="method-args">(src, opt = &quot;&quot;, &amp;b)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000523-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000523-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 489</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">try_run</span>(<span class="ruby-identifier">src</span>, <span class="ruby-identifier">opt</span> = <span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
  <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">try_link0</span>(<span class="ruby-identifier">src</span>, <span class="ruby-identifier">opt</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
    <span class="ruby-identifier">xsystem</span>(<span class="ruby-value str">&quot;./conftest&quot;</span>)
  <span class="ruby-keyword kw">else</span>
    <span class="ruby-keyword kw">nil</span>
  <span class="ruby-keyword kw">end</span>
<span class="ruby-keyword kw">ensure</span>
  <span class="ruby-identifier">rm_f</span> <span class="ruby-value str">&quot;conftest*&quot;</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000517" class="method-detail">
        <a name="M000517"></a>

        <div class="method-heading">
          <a href="#M000517" class="method-signature">
          <span class="method-name">try_static_assert</span><span class="method-args">(expr, headers = nil, opt = &quot;&quot;, &amp;b)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000517-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000517-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 362</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">try_static_assert</span>(<span class="ruby-identifier">expr</span>, <span class="ruby-identifier">headers</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">opt</span> = <span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
  <span class="ruby-identifier">headers</span> = <span class="ruby-identifier">cpp_include</span>(<span class="ruby-identifier">headers</span>)
  <span class="ruby-identifier">try_compile</span>(<span class="ruby-value str">&quot;\#{COMMON_HEADERS}\n\#{headers}\n/*top*/\nint conftest_const[(\#{expr}) ? 1 : -1];\n&quot;</span>, <span class="ruby-identifier">opt</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000520" class="method-detail">
        <a name="M000520"></a>

        <div class="method-heading">
          <a href="#M000520" class="method-signature">
          <span class="method-name">try_var</span><span class="method-args">(var, headers = nil, &amp;b)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000520-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000520-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 439</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">try_var</span>(<span class="ruby-identifier">var</span>, <span class="ruby-identifier">headers</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
  <span class="ruby-identifier">headers</span> = <span class="ruby-identifier">cpp_include</span>(<span class="ruby-identifier">headers</span>)
  <span class="ruby-identifier">try_compile</span>(<span class="ruby-value str">&quot;\#{COMMON_HEADERS}\n\#{headers}\n/*top*/\nint main() { return 0; }\nint t() { const volatile void *volatile p; p = &amp;(&amp;\#{var})[0]; return 0; }\n&quot;</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000542" class="method-detail">
        <a name="M000542"></a>

        <div class="method-heading">
          <a href="#M000542" class="method-signature">
          <span class="method-name">what_type?</span><span class="method-args">(type, member = nil, headers = nil, &amp;b)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000542-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000542-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 840</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">what_type?</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">member</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">headers</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
  <span class="ruby-identifier">m</span> = <span class="ruby-node">&quot;#{type}&quot;</span>
  <span class="ruby-identifier">name</span> = <span class="ruby-identifier">type</span>
  <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">member</span>
    <span class="ruby-identifier">m</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;.&quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">member</span>
    <span class="ruby-identifier">name</span> = <span class="ruby-node">&quot;(((#{type} *)0)-&gt;#{member})&quot;</span>
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-identifier">fmt</span> = <span class="ruby-value str">&quot;seems %s&quot;</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">fmt</span>.<span class="ruby-operator">%</span>(<span class="ruby-identifier">x</span>)
    <span class="ruby-identifier">x</span> <span class="ruby-value">? </span><span class="ruby-keyword kw">super</span> <span class="ruby-operator">:</span> <span class="ruby-value str">&quot;unknown&quot;</span>
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-identifier">checking_for</span> <span class="ruby-identifier">checking_message</span>(<span class="ruby-identifier">m</span>, <span class="ruby-identifier">headers</span>), <span class="ruby-identifier">fmt</span> <span class="ruby-keyword kw">do</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">scalar_ptr_type?</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">member</span>, <span class="ruby-identifier">headers</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
      <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">try_static_assert</span>(<span class="ruby-node">&quot;sizeof(*#{name}) == 1&quot;</span>, <span class="ruby-identifier">headers</span>)
        <span class="ruby-value str">&quot;string&quot;</span>
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">scalar_type?</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">member</span>, <span class="ruby-identifier">headers</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">b</span>)
      <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">try_static_assert</span>(<span class="ruby-node">&quot;sizeof(#{name}) &gt; sizeof(long)&quot;</span>, <span class="ruby-identifier">headers</span>)
        <span class="ruby-value str">&quot;long long&quot;</span>
      <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">try_static_assert</span>(<span class="ruby-node">&quot;sizeof(#{name}) &gt; sizeof(int)&quot;</span>, <span class="ruby-identifier">headers</span>)
        <span class="ruby-value str">&quot;long&quot;</span>
      <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">try_static_assert</span>(<span class="ruby-node">&quot;sizeof(#{name}) &gt; sizeof(short)&quot;</span>, <span class="ruby-identifier">headers</span>)
        <span class="ruby-value str">&quot;int&quot;</span>
      <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">try_static_assert</span>(<span class="ruby-node">&quot;sizeof(#{name}) &gt; 1&quot;</span>, <span class="ruby-identifier">headers</span>)
        <span class="ruby-value str">&quot;short&quot;</span>
      <span class="ruby-keyword kw">else</span>
        <span class="ruby-value str">&quot;char&quot;</span>
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000552" class="method-detail">
        <a name="M000552"></a>

        <div class="method-heading">
          <a href="#M000552" class="method-signature">
          <span class="method-name">winsep</span><span class="method-args">(s)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000552-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000552-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 1041</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">winsep</span>(<span class="ruby-identifier">s</span>)
  <span class="ruby-identifier">s</span>.<span class="ruby-identifier">tr</span>(<span class="ruby-value str">'/'</span>, <span class="ruby-value str">'\\'</span>)
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000515" class="method-detail">
        <a name="M000515"></a>

        <div class="method-heading">
          <a href="#M000515" class="method-signature">
          <span class="method-name">with_cflags</span><span class="method-args">(flags) {|| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000515-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000515-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 346</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">with_cflags</span>(<span class="ruby-identifier">flags</span>)
  <span class="ruby-identifier">cflags</span> = <span class="ruby-identifier">$CFLAGS</span>
  <span class="ruby-identifier">$CFLAGS</span> = <span class="ruby-identifier">flags</span>
  <span class="ruby-identifier">ret</span> = <span class="ruby-keyword kw">yield</span>
<span class="ruby-keyword kw">ensure</span>
  <span class="ruby-identifier">$CFLAGS</span> = <span class="ruby-identifier">cflags</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">ret</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000546" class="method-detail">
        <a name="M000546"></a>

        <div class="method-heading">
          <a href="#M000546" class="method-signature">
          <span class="method-name">with_config</span><span class="method-args">(config, *defaults) {|config, *defaults| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000546-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000546-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 904</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">with_config</span>(<span class="ruby-identifier">config</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">defaults</span>)
  <span class="ruby-identifier">config</span> = <span class="ruby-identifier">config</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/^--with[-_]/</span>, <span class="ruby-value str">''</span>)
  <span class="ruby-identifier">val</span> = <span class="ruby-identifier">arg_config</span>(<span class="ruby-value str">&quot;--with-&quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">config</span>) <span class="ruby-keyword kw">do</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">arg_config</span>(<span class="ruby-value str">&quot;--without-&quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">config</span>)
      <span class="ruby-keyword kw">false</span>
    <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">block_given?</span>
      <span class="ruby-keyword kw">yield</span>(<span class="ruby-identifier">config</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">defaults</span>)
    <span class="ruby-keyword kw">else</span>
      <span class="ruby-keyword kw">break</span> <span class="ruby-operator">*</span><span class="ruby-identifier">defaults</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">val</span>
  <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;yes&quot;</span>
    <span class="ruby-keyword kw">true</span>
  <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;no&quot;</span>
    <span class="ruby-keyword kw">false</span>
  <span class="ruby-keyword kw">else</span>
    <span class="ruby-identifier">val</span>
  <span class="ruby-keyword kw">end</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000514" class="method-detail">
        <a name="M000514"></a>

        <div class="method-heading">
          <a href="#M000514" class="method-signature">
          <span class="method-name">with_cppflags</span><span class="method-args">(flags) {|| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000514-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000514-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 338</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">with_cppflags</span>(<span class="ruby-identifier">flags</span>)
  <span class="ruby-identifier">cppflags</span> = <span class="ruby-identifier">$CPPFLAGS</span>
  <span class="ruby-identifier">$CPPFLAGS</span> = <span class="ruby-identifier">flags</span>
  <span class="ruby-identifier">ret</span> = <span class="ruby-keyword kw">yield</span>
<span class="ruby-keyword kw">ensure</span>
  <span class="ruby-identifier">$CPPFLAGS</span> = <span class="ruby-identifier">cppflags</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">ret</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000551" class="method-detail">
        <a name="M000551"></a>

        <div class="method-heading">
          <a href="#M000551" class="method-signature">
          <span class="method-name">with_destdir</span><span class="method-args">(dir)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000551-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000551-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 1036</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">with_destdir</span>(<span class="ruby-identifier">dir</span>)
  <span class="ruby-identifier">dir</span> = <span class="ruby-identifier">dir</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-identifier">$dest_prefix_pattern</span>, <span class="ruby-value str">''</span>)
  <span class="ruby-regexp re">/\A\$[\(\{]/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">dir</span> <span class="ruby-value">? </span><span class="ruby-identifier">dir</span> <span class="ruby-operator">:</span> <span class="ruby-value str">&quot;$(DESTDIR)&quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">dir</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000516" class="method-detail">
        <a name="M000516"></a>

        <div class="method-heading">
          <a href="#M000516" class="method-signature">
          <span class="method-name">with_ldflags</span><span class="method-args">(flags) {|| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000516-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000516-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 354</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">with_ldflags</span>(<span class="ruby-identifier">flags</span>)
  <span class="ruby-identifier">ldflags</span> = <span class="ruby-identifier">$LDFLAGS</span>
  <span class="ruby-identifier">$LDFLAGS</span> = <span class="ruby-identifier">flags</span>
  <span class="ruby-identifier">ret</span> = <span class="ruby-keyword kw">yield</span>
<span class="ruby-keyword kw">ensure</span>
  <span class="ruby-identifier">$LDFLAGS</span> = <span class="ruby-identifier">ldflags</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">ret</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000501" class="method-detail">
        <a name="M000501"></a>

        <div class="method-heading">
          <a href="#M000501" class="method-signature">
          <span class="method-name">xpopen</span><span class="method-args">(command, *mode, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000501-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000501-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 226</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">xpopen</span> <span class="ruby-identifier">command</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">mode</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>
  <span class="ruby-constant">Logging</span><span class="ruby-operator">::</span><span class="ruby-identifier">open</span> <span class="ruby-keyword kw">do</span>
    <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">mode</span>[<span class="ruby-value">0</span>]
    <span class="ruby-keyword kw">when</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-regexp re">/^r/</span>
      <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{command} |&quot;</span>
    <span class="ruby-keyword kw">else</span>
      <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;| #{command}&quot;</span>
    <span class="ruby-keyword kw">end</span>
    <span class="ruby-constant">IO</span>.<span class="ruby-identifier">popen</span>(<span class="ruby-identifier">command</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">mode</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword kw">end</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000500" class="method-detail">
        <a name="M000500"></a>

        <div class="method-heading">
          <a href="#M000500" class="method-signature">
          <span class="method-name">xsystem</span><span class="method-args">(command)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000500-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000500-source">
<pre>
<span class="ruby-comment cmt"># File mkmf.rb, line 219</span>
<span class="ruby-keyword kw">def</span> <span class="ruby-identifier">xsystem</span> <span class="ruby-identifier">command</span>
  <span class="ruby-constant">Logging</span><span class="ruby-operator">::</span><span class="ruby-identifier">open</span> <span class="ruby-keyword kw">do</span>
    <span class="ruby-identifier">puts</span> <span class="ruby-identifier">command</span>.<span class="ruby-identifier">quote</span>
    <span class="ruby-identifier">system</span>(<span class="ruby-identifier">command</span>)
  <span class="ruby-keyword kw">end</span>
<span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>