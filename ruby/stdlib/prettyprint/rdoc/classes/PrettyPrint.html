<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: PrettyPrint</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">PrettyPrint</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../files/prettyprint_rb.html">
                prettyprint.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Object
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
This class implements a pretty printing algorithm. It finds line breaks and
nice indentations for grouped structure.
</p>
<p>
By default, the class assumes that primitive elements are strings and each
byte in the strings have single column in width. But it can be used for
other situations by giving suitable arguments for some methods:
</p>
<ul>
<li>newline object and space generation block for <a
href="PrettyPrint.html#M001705">PrettyPrint.new</a>

</li>
<li>optional width argument for <a
href="PrettyPrint.html#M001709">PrettyPrint#text</a>

</li>
<li><a href="PrettyPrint.html#M001711">PrettyPrint#breakable</a>

</li>
</ul>
<p>
There are several candidate uses:
</p>
<ul>
<li><a href="PrettyPrint.html#M001709">text</a> formatting using proportional
fonts

</li>
<li>multibyte characters which has columns different to number of bytes

</li>
<li>non-string formatting

</li>
</ul>
<h2>Bugs</h2>
<ul>
<li>Box based formatting?

</li>
<li>Other (better) model/algorithm?

</li>
</ul>
<h2>References</h2>
<p>
Christian Lindig, Strictly Pretty, March 2000, <a
href="http://www.st.cs.uni-sb.de/~lindig/papers/#pretty">www.st.cs.uni-sb.de/~lindig/papers/#pretty</a>
</p>
<p>
Philip Wadler, A prettier printer, March 1998, <a
href="http://homepages.inf.ed.ac.uk/wadler/topics/language-design.html#prettier">homepages.inf.ed.ac.uk/wadler/topics/language-design.html#prettier</a>
</p>
<h2>Author</h2>
<p>
Tanaka Akira &lt;akr@m17n.org&gt;
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M001708">break_outmost_groups</a>&nbsp;&nbsp;
      <a href="#M001711">breakable</a>&nbsp;&nbsp;
      <a href="#M001706">current_group</a>&nbsp;&nbsp;
      <a href="#M001710">fill_breakable</a>&nbsp;&nbsp;
      <a href="#M001707">first?</a>&nbsp;&nbsp;
      <a href="#M001715">flush</a>&nbsp;&nbsp;
      <a href="#M001703">format</a>&nbsp;&nbsp;
      <a href="#M001712">group</a>&nbsp;&nbsp;
      <a href="#M001713">group_sub</a>&nbsp;&nbsp;
      <a href="#M001714">nest</a>&nbsp;&nbsp;
      <a href="#M001705">new</a>&nbsp;&nbsp;
      <a href="#M001704">singleline_format</a>&nbsp;&nbsp;
      <a href="#M001709">text</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">

    <div id="class-list">
      <h3 class="section-bar">Classes and Modules</h3>

      Class <a href="PrettyPrint/Breakable.html" class="link">PrettyPrint::Breakable</a><br />
Class <a href="PrettyPrint/Group.html" class="link">PrettyPrint::Group</a><br />
Class <a href="PrettyPrint/GroupQueue.html" class="link">PrettyPrint::GroupQueue</a><br />
Class <a href="PrettyPrint/SingleLine.html" class="link">PrettyPrint::SingleLine</a><br />
Class <a href="PrettyPrint/Text.html" class="link">PrettyPrint::Text</a><br />

    </div>




    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">genspace</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">group_queue</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">indent</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">maxwidth</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">newline</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">output</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M001703" class="m-detail">
        <a name="M001703"></a>

        <div class="method-heading">
          <a href="#M001703" class="method-signature">
          <span class="method-name">format</span><span class="method-args">(output='', maxwidth=79, newline=&quot;\n&quot;, genspace=lambda {|n| ' ' * n} {|q| ...}</span>
          </a>
        </div>
      
        <div class="m-description">
          <p>
This is a convenience method which is same as follows:
</p>
<pre>
  begin
    q = PrettyPrint.new(output, maxwidth, newline, &amp;genspace)
    ...
    q.flush
    output
  end
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001703-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001703-source">
<pre>
<span class="ruby-comment cmt"># File prettyprint.rb, line 43</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-constant">PrettyPrint</span>.<span class="ruby-identifier">format</span>(<span class="ruby-identifier">output</span>=<span class="ruby-value str">''</span>, <span class="ruby-identifier">maxwidth</span>=<span class="ruby-value">79</span>, <span class="ruby-identifier">newline</span>=<span class="ruby-value str">&quot;\n&quot;</span>, <span class="ruby-identifier">genspace</span>=<span class="ruby-identifier">lambda</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">n</span><span class="ruby-operator">|</span> <span class="ruby-value str">' '</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">n</span>})
    <span class="ruby-identifier">q</span> = <span class="ruby-constant">PrettyPrint</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">output</span>, <span class="ruby-identifier">maxwidth</span>, <span class="ruby-identifier">newline</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">genspace</span>)
    <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">q</span>
    <span class="ruby-identifier">q</span>.<span class="ruby-identifier">flush</span>
    <span class="ruby-identifier">output</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001705" class="m-detail">
        <a name="M001705"></a>

        <div class="method-heading">
          <a href="#M001705" class="method-signature">
          <span class="method-name">new</span><span class="method-args">(output='', maxwidth=79, newline=&quot;\n&quot;, &amp;genspace)</span>
          </a>
        </div>
      
        <div class="m-description">
          <p>
Creates a buffer for pretty printing.
</p>
<p>
<tt>output</tt> is an output target. If it is not specified, &#8217;&#8217;
is assumed. It should have a &lt;&lt; method which accepts the first
argument <tt>obj</tt> of <a
href="PrettyPrint.html#M001709">PrettyPrint#text</a>, the first argument
<tt>sep</tt> of <a
href="PrettyPrint.html#M001711">PrettyPrint#breakable</a>, the first
argument <tt>newline</tt> of <a
href="PrettyPrint.html#M001705">PrettyPrint.new</a>, and the result of a
given block for <a href="PrettyPrint.html#M001705">PrettyPrint.new</a>.
</p>
<p>
<tt>maxwidth</tt> specifies maximum line length. If it is not specified, 79
is assumed. However actual outputs may overflow <tt>maxwidth</tt> if long
non-<a href="PrettyPrint.html#M001711">breakable</a> texts are provided.
</p>
<p>
<tt>newline</tt> is used for line breaks. &quot;\n&quot; is used if it is
not specified.
</p>
<p>
The block is used to generate spaces. {|width| &#8217; &#8217; * width} is
used if it is not given.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001705-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001705-source">
<pre>
<span class="ruby-comment cmt"># File prettyprint.rb, line 80</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">output</span>=<span class="ruby-value str">''</span>, <span class="ruby-identifier">maxwidth</span>=<span class="ruby-value">79</span>, <span class="ruby-identifier">newline</span>=<span class="ruby-value str">&quot;\n&quot;</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">genspace</span>)
    <span class="ruby-ivar">@output</span> = <span class="ruby-identifier">output</span>
    <span class="ruby-ivar">@maxwidth</span> = <span class="ruby-identifier">maxwidth</span>
    <span class="ruby-ivar">@newline</span> = <span class="ruby-identifier">newline</span>
    <span class="ruby-ivar">@genspace</span> = <span class="ruby-identifier">genspace</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">lambda</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">n</span><span class="ruby-operator">|</span> <span class="ruby-value str">' '</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">n</span>}

    <span class="ruby-ivar">@output_width</span> = <span class="ruby-value">0</span>
    <span class="ruby-ivar">@buffer_width</span> = <span class="ruby-value">0</span>
    <span class="ruby-ivar">@buffer</span> = []

    <span class="ruby-identifier">root_group</span> = <span class="ruby-constant">Group</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">0</span>)
    <span class="ruby-ivar">@group_stack</span> = [<span class="ruby-identifier">root_group</span>]
    <span class="ruby-ivar">@group_queue</span> = <span class="ruby-constant">GroupQueue</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">root_group</span>)
    <span class="ruby-ivar">@indent</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001704" class="m-detail">
        <a name="M001704"></a>

        <div class="method-heading">
          <a href="#M001704" class="method-signature">
          <span class="method-name">singleline_format</span><span class="method-args">(output='', maxwidth=nil, newline=nil, genspace=nil) {|q| ...}</span>
          </a>
        </div>
      
        <div class="m-description">
          <p>
This is similar to PrettyPrint::format but the result has no breaks.
</p>
<p>
<tt>maxwidth</tt>, <tt>newline</tt> and <tt>genspace</tt> are ignored.
</p>
<p>
The invocation of <tt><a href="PrettyPrint.html#M001711">breakable</a></tt>
in the block doesn&#8216;t break a line and is treated as just an
invocation of <tt><a href="PrettyPrint.html#M001709">text</a></tt>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001704-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001704-source">
<pre>
<span class="ruby-comment cmt"># File prettyprint.rb, line 57</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-constant">PrettyPrint</span>.<span class="ruby-identifier">singleline_format</span>(<span class="ruby-identifier">output</span>=<span class="ruby-value str">''</span>, <span class="ruby-identifier">maxwidth</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">newline</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">genspace</span>=<span class="ruby-keyword kw">nil</span>)
    <span class="ruby-identifier">q</span> = <span class="ruby-constant">SingleLine</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">output</span>)
    <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">q</span>
    <span class="ruby-identifier">output</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M001708" class="m-detail">
        <a name="M001708"></a>

        <div class="method-heading">
          <a href="#M001708" class="method-signature">
          <span class="method-name">break_outmost_groups</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="m-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001708-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001708-source">
<pre>
<span class="ruby-comment cmt"># File prettyprint.rb, line 124</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">break_outmost_groups</span>
    <span class="ruby-keyword kw">while</span> <span class="ruby-ivar">@maxwidth</span> <span class="ruby-operator">&lt;</span> <span class="ruby-ivar">@output_width</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@buffer_width</span>
      <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">group</span> = <span class="ruby-ivar">@group_queue</span>.<span class="ruby-identifier">deq</span>
      <span class="ruby-keyword kw">until</span> <span class="ruby-identifier">group</span>.<span class="ruby-identifier">breakables</span>.<span class="ruby-identifier">empty?</span>
        <span class="ruby-identifier">data</span> = <span class="ruby-ivar">@buffer</span>.<span class="ruby-identifier">shift</span>
        <span class="ruby-ivar">@output_width</span> = <span class="ruby-identifier">data</span>.<span class="ruby-identifier">output</span>(<span class="ruby-ivar">@output</span>, <span class="ruby-ivar">@output_width</span>)
        <span class="ruby-ivar">@buffer_width</span> <span class="ruby-operator">-=</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">width</span>
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">while</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@buffer</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">Text</span> <span class="ruby-operator">===</span> <span class="ruby-ivar">@buffer</span>.<span class="ruby-identifier">first</span>
        <span class="ruby-identifier">text</span> = <span class="ruby-ivar">@buffer</span>.<span class="ruby-identifier">shift</span>
        <span class="ruby-ivar">@output_width</span> = <span class="ruby-identifier">text</span>.<span class="ruby-identifier">output</span>(<span class="ruby-ivar">@output</span>, <span class="ruby-ivar">@output_width</span>)
        <span class="ruby-ivar">@buffer_width</span> <span class="ruby-operator">-=</span> <span class="ruby-identifier">text</span>.<span class="ruby-identifier">width</span>
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001711" class="m-detail">
        <a name="M001711"></a>

        <div class="method-heading">
          <a href="#M001711" class="method-signature">
          <span class="method-name">breakable</span><span class="method-args">(sep=' ', width=sep.length)</span>
          </a>
        </div>
      
        <div class="m-description">
          <p>
This tells &quot;you can break a line here if necessary&quot;, and a
<tt>width</tt>\-column <a href="PrettyPrint.html#M001709">text</a>
<tt>sep</tt> is inserted if a line is not broken at the point.
</p>
<p>
If <tt>sep</tt> is not specified, &quot; &quot; is used.
</p>
<p>
If <tt>width</tt> is not specified, +sep.length+ is used. You will have to
specify this when <tt>sep</tt> is a multibyte character, for example.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001711-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001711-source">
<pre>
<span class="ruby-comment cmt"># File prettyprint.rb, line 172</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">breakable</span>(<span class="ruby-identifier">sep</span>=<span class="ruby-value str">' '</span>, <span class="ruby-identifier">width</span>=<span class="ruby-identifier">sep</span>.<span class="ruby-identifier">length</span>)
    <span class="ruby-identifier">group</span> = <span class="ruby-ivar">@group_stack</span>.<span class="ruby-identifier">last</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">group</span>.<span class="ruby-identifier">break?</span>
      <span class="ruby-identifier">flush</span>
      <span class="ruby-ivar">@output</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@newline</span>
      <span class="ruby-ivar">@output</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@genspace</span>.<span class="ruby-identifier">call</span>(<span class="ruby-ivar">@indent</span>)
      <span class="ruby-ivar">@output_width</span> = <span class="ruby-ivar">@indent</span>
      <span class="ruby-ivar">@buffer_width</span> = <span class="ruby-value">0</span>
    <span class="ruby-keyword kw">else</span>
      <span class="ruby-ivar">@buffer</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Breakable</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">sep</span>, <span class="ruby-identifier">width</span>, <span class="ruby-keyword kw">self</span>)
      <span class="ruby-ivar">@buffer_width</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">width</span>
      <span class="ruby-identifier">break_outmost_groups</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001706" class="m-detail">
        <a name="M001706"></a>

        <div class="method-heading">
          <a href="#M001706" class="method-signature">
          <span class="method-name">current_group</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="m-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001706-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001706-source">
<pre>
<span class="ruby-comment cmt"># File prettyprint.rb, line 98</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">current_group</span>
    <span class="ruby-ivar">@group_stack</span>.<span class="ruby-identifier">last</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001710" class="m-detail">
        <a name="M001710"></a>

        <div class="method-heading">
          <a href="#M001710" class="method-signature">
          <span class="method-name">fill_breakable</span><span class="method-args">(sep=' ', width=sep.length)</span>
          </a>
        </div>
      
        <div class="m-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001710-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001710-source">
<pre>
<span class="ruby-comment cmt"># File prettyprint.rb, line 160</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">fill_breakable</span>(<span class="ruby-identifier">sep</span>=<span class="ruby-value str">' '</span>, <span class="ruby-identifier">width</span>=<span class="ruby-identifier">sep</span>.<span class="ruby-identifier">length</span>)
    <span class="ruby-identifier">group</span> { <span class="ruby-identifier">breakable</span> <span class="ruby-identifier">sep</span>, <span class="ruby-identifier">width</span> }
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001707" class="m-detail">
        <a name="M001707"></a>

        <div class="method-heading">
          <a href="#M001707" class="method-signature">
          <span class="method-name">first?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="m-description">
          <p>
<a href="PrettyPrint.html#M001707">first?</a> is a predicate to test the
call is a first call to <a href="PrettyPrint.html#M001707">first?</a> with
current <a href="PrettyPrint.html#M001712">group</a>.
</p>
<p>
It is useful to <a href="PrettyPrint.html#M001703">format</a> comma
separated values as:
</p>
<pre>
  q.group(1, '[', ']') {
    xxx.each {|yyy|
      unless q.first?
        q.text ','
        q.breakable
      end
      ... pretty printing yyy ...
    }
  }
</pre>
<p>
<a href="PrettyPrint.html#M001707">first?</a> is obsoleted in 1.8.2.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001707-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001707-source">
<pre>
<span class="ruby-comment cmt"># File prettyprint.rb, line 119</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">first?</span>
    <span class="ruby-identifier">warn</span> <span class="ruby-value str">&quot;PrettyPrint#first? is obsoleted at 1.8.2.&quot;</span>
    <span class="ruby-identifier">current_group</span>.<span class="ruby-identifier">first?</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001715" class="m-detail">
        <a name="M001715"></a>

        <div class="method-heading">
          <a href="#M001715" class="method-signature">
          <span class="method-name">flush</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="m-description">
          <p>
outputs buffered data.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001715-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001715-source">
<pre>
<span class="ruby-comment cmt"># File prettyprint.rb, line 235</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">flush</span>
    <span class="ruby-ivar">@buffer</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">data</span><span class="ruby-operator">|</span>
      <span class="ruby-ivar">@output_width</span> = <span class="ruby-identifier">data</span>.<span class="ruby-identifier">output</span>(<span class="ruby-ivar">@output</span>, <span class="ruby-ivar">@output_width</span>)
    }
    <span class="ruby-ivar">@buffer</span>.<span class="ruby-identifier">clear</span>
    <span class="ruby-ivar">@buffer_width</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001712" class="m-detail">
        <a name="M001712"></a>

        <div class="method-heading">
          <a href="#M001712" class="method-signature">
          <span class="method-name">group</span><span class="method-args">(indent=0, open_obj='', close_obj='', open_width=open_obj.length, close_width=close_obj.length) {|| ...}</span>
          </a>
        </div>
      
        <div class="m-description">
          <p>
Groups line break hints added in the block. The line break hints are all to
be used or not.
</p>
<p>
If <tt>indent</tt> is specified, the method call is regarded as nested by
<a href="PrettyPrint.html#M001714">nest</a>(indent) { &#8230; }.
</p>
<p>
If <tt>open_obj</tt> is specified, <tt><a
href="PrettyPrint.html#M001709">text</a> open_obj, open_width</tt> is
called before grouping. If <tt>close_obj</tt> is specified, <tt><a
href="PrettyPrint.html#M001709">text</a> close_obj, close_width</tt> is
called after grouping.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001712-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001712-source">
<pre>
<span class="ruby-comment cmt"># File prettyprint.rb, line 197</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">group</span>(<span class="ruby-identifier">indent</span>=<span class="ruby-value">0</span>, <span class="ruby-identifier">open_obj</span>=<span class="ruby-value str">''</span>, <span class="ruby-identifier">close_obj</span>=<span class="ruby-value str">''</span>, <span class="ruby-identifier">open_width</span>=<span class="ruby-identifier">open_obj</span>.<span class="ruby-identifier">length</span>, <span class="ruby-identifier">close_width</span>=<span class="ruby-identifier">close_obj</span>.<span class="ruby-identifier">length</span>)
    <span class="ruby-identifier">text</span> <span class="ruby-identifier">open_obj</span>, <span class="ruby-identifier">open_width</span>
    <span class="ruby-identifier">group_sub</span> {
      <span class="ruby-identifier">nest</span>(<span class="ruby-identifier">indent</span>) {
        <span class="ruby-keyword kw">yield</span>
      }
    }
    <span class="ruby-identifier">text</span> <span class="ruby-identifier">close_obj</span>, <span class="ruby-identifier">close_width</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001713" class="m-detail">
        <a name="M001713"></a>

        <div class="method-heading">
          <a href="#M001713" class="method-signature">
          <span class="method-name">group_sub</span><span class="method-args">() {|| ...}</span>
          </a>
        </div>
      
        <div class="m-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001713-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001713-source">
<pre>
<span class="ruby-comment cmt"># File prettyprint.rb, line 207</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">group_sub</span>
    <span class="ruby-identifier">group</span> = <span class="ruby-constant">Group</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@group_stack</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">depth</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>)
    <span class="ruby-ivar">@group_stack</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">group</span>
    <span class="ruby-ivar">@group_queue</span>.<span class="ruby-identifier">enq</span> <span class="ruby-identifier">group</span>
    <span class="ruby-keyword kw">begin</span>
      <span class="ruby-keyword kw">yield</span>
    <span class="ruby-keyword kw">ensure</span>
      <span class="ruby-ivar">@group_stack</span>.<span class="ruby-identifier">pop</span>
      <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">group</span>.<span class="ruby-identifier">breakables</span>.<span class="ruby-identifier">empty?</span>
        <span class="ruby-ivar">@group_queue</span>.<span class="ruby-identifier">delete</span> <span class="ruby-identifier">group</span>
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001714" class="m-detail">
        <a name="M001714"></a>

        <div class="method-heading">
          <a href="#M001714" class="method-signature">
          <span class="method-name">nest</span><span class="method-args">(indent) {|| ...}</span>
          </a>
        </div>
      
        <div class="m-description">
          <p>
Increases left margin after newline with <tt>indent</tt> for line breaks
added in the block.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001714-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001714-source">
<pre>
<span class="ruby-comment cmt"># File prettyprint.rb, line 224</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">nest</span>(<span class="ruby-identifier">indent</span>)
    <span class="ruby-ivar">@indent</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">indent</span>
    <span class="ruby-keyword kw">begin</span>
      <span class="ruby-keyword kw">yield</span>
    <span class="ruby-keyword kw">ensure</span>
      <span class="ruby-ivar">@indent</span> <span class="ruby-operator">-=</span> <span class="ruby-identifier">indent</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M001709" class="m-detail">
        <a name="M001709"></a>

        <div class="method-heading">
          <a href="#M001709" class="method-signature">
          <span class="method-name">text</span><span class="method-args">(obj, width=obj.length)</span>
          </a>
        </div>
      
        <div class="m-description">
          <p>
This adds <tt>obj</tt> as a <a href="PrettyPrint.html#M001709">text</a> of
<tt>width</tt> columns in width.
</p>
<p>
If <tt>width</tt> is not specified, obj.length is used.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001709-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001709-source">
<pre>
<span class="ruby-comment cmt"># File prettyprint.rb, line 144</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">text</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">width</span>=<span class="ruby-identifier">obj</span>.<span class="ruby-identifier">length</span>)
    <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@buffer</span>.<span class="ruby-identifier">empty?</span>
      <span class="ruby-ivar">@output</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">obj</span>
      <span class="ruby-ivar">@output_width</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">width</span>
    <span class="ruby-keyword kw">else</span>
      <span class="ruby-identifier">text</span> = <span class="ruby-ivar">@buffer</span>.<span class="ruby-identifier">last</span>
      <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Text</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">text</span>
        <span class="ruby-identifier">text</span> = <span class="ruby-constant">Text</span>.<span class="ruby-identifier">new</span>
        <span class="ruby-ivar">@buffer</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">text</span>
      <span class="ruby-keyword kw">end</span>
      <span class="ruby-identifier">text</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">width</span>)
      <span class="ruby-ivar">@buffer_width</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">width</span>
      <span class="ruby-identifier">break_outmost_groups</span>
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>
<div id='credits' style='font-size:smaller' >
<!-- 1  --><p> <a href='http://www.ruby-doc.org'>ruby-doc.org</a> is hosted and maintained by <a href='http://www.jamesbritt.com'>James Britt</a> and <a href='http://www.happycamperstudios.com'>Happy Camper Studios</a>, a <a href='http://www.happycamperstudios.com'> Ruby application development company in Phoenix, Arizona</a>. The site was created in 2002 as part of the Ruby Documentation Project to promote the Ruby language and to help other Ruby hackers.</p>
 <p>Documentation content on ruby-doc.org is provided by <a href='http://www.ruby-doc.org/about'>remarkable members</a> of the Ruby community.</p>
<p>For more information on the Ruby programming language, visit <a href='http://www.ruby-lang.org'>ruby-lang.org</a>.</p>
<p>Want to help improve Ruby's API docs? See <a href='/documentation-guidelines.html'> Ruby Documentation Guidelines</a>.</p>
</div>

</body>
</html>